<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ê∏∏ÊàèÊô∫ËÉΩÂä©Êâã ¬∑ ‰Ω†ÁöÑ‰∏ìÂ±ûÊ∏∏ÊàèAIÈ°æÈóÆ</title>
  <style>
    :root{
      --bg:#0a0d16; --bg1:#0e1220; --bg2:#151B2E;
      --brand1:#00d4ff; --brand2:#8b5cf6; --brand3:#10b981;
      --accent:#ff6b6b; --gold:#fbbf24;
      --muted:#94a3b8; --glass: rgba(255,255,255,.08);
      --outline: rgba(255,255,255,.12); --ring: rgba(0,212,255,.3);
      --shadow: 0 25px 70px rgba(0,0,0,.4);
      --glow: 0 0 30px rgba(0,212,255,.2);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: 'SF Pro Display', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, 'PingFang SC', sans-serif;
      background:
        radial-gradient(1400px 700px at 80% -15%, rgba(0,212,255,.15), transparent 65%),
        radial-gradient(1200px 900px at -15% 110%, rgba(139,92,246,.18), transparent 65%),
        radial-gradient(800px 600px at 50% 50%, rgba(16,185,129,.08), transparent 70%),
        linear-gradient(150deg, var(--bg1), var(--bg2));
      color:#f1f5f9; min-height:100vh; overflow-x:hidden;
    }
    .app{max-width:440px;margin:0 auto;min-height:100vh;display:flex;flex-direction:column;position:relative}

    .header{position:sticky;top:0;z-index:20;backdrop-filter: blur(15px);
      background: linear-gradient(180deg, rgba(10,13,22,.9), rgba(10,13,22,.4) 70%, transparent);
      padding:15px 18px 0;border-bottom:1px solid var(--outline)}
    .logo-section{display:flex;gap:14px;align-items:center;margin-bottom:12px}
    .logo{width:38px;height:38px;border-radius:12px;
      background:conic-gradient(from 200deg, var(--brand1), var(--brand2), var(--accent));
      box-shadow:var(--glow), inset 0 0 20px rgba(255,255,255,.1);
      position:relative;overflow:hidden}
    .logo::after{content:'üéÆ';position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:18px}
    .title{font-weight:900;letter-spacing:-.02em;font-size:18px}
    .subtitle{font-size:13px;color:var(--muted);margin-top:1px}

    /* Êñ∞Â¢ûÔºöÈ°∂ÈÉ®TabÂØºËà™ */
    .nav-tabs{display:flex;background:rgba(255,255,255,.04);border-radius:16px;padding:4px;margin-bottom:15px}
    .tab{flex:1;padding:10px 8px;border-radius:12px;text-align:center;font-size:13px;font-weight:600;
      cursor:pointer;transition:all .3s;position:relative;display:flex;align-items:center;justify-content:center;gap:6px}
    .tab.active{background:linear-gradient(135deg, var(--brand1), var(--brand2));
      color:#0a0d16;box-shadow:0 8px 25px rgba(0,212,255,.25)}
    .tab:not(.active){color:var(--muted)}
    .tab:not(.active):hover{background:rgba(255,255,255,.06);color:#e2e8f0}

    .input-section{padding:0 18px 8px}
    .input-bar{display:flex;gap:12px;align-items:center;background:var(--glass);
      border:1px solid var(--outline);border-radius:20px;padding:12px 16px;
      box-shadow: var(--shadow);transition:all .3s ease;position:relative;overflow:hidden}
    .input-bar::before{content:'';position:absolute;inset:0;background:linear-gradient(45deg, transparent, rgba(0,212,255,.02), transparent);opacity:0;transition:opacity .3s}
    .input-bar:hover::before{opacity:1}
    .input-bar:hover{border-color:rgba(0,212,255,.3);box-shadow:var(--shadow),var(--glow)}
    .input-bar input{flex:1;background:transparent;border:none;outline:none;color:#fff;font-size:16px;font-weight:500}
    .input-bar input::placeholder{color:var(--muted)}
    .action-btn{border:none;cursor:pointer;color:#0a0d16;font-weight:800;border-radius:16px;
      background:linear-gradient(135deg,var(--brand1),var(--brand2)); padding:12px 20px; 
      box-shadow:0 15px 40px var(--ring);transition:all .2s ease;position:relative}
    .action-btn:hover{transform:translateY(-1px);box-shadow:0 20px 50px var(--ring)}
    .action-btn.guide{background:linear-gradient(135deg,var(--accent),var(--gold))}

    /* Êô∫ËÉΩÂª∫ËÆÆÊù° */
    .smart-suggestions{padding:8px 18px;display:none}
    .smart-suggestions.show{display:block}
    .suggestion-item{display:flex;align-items:center;gap:10px;padding:12px 16px;margin-bottom:8px;
      background:linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--outline);border-radius:16px;cursor:pointer;transition:all .3s}
    .suggestion-item:hover{background:linear-gradient(135deg, rgba(0,212,255,.1), rgba(139,92,246,.05));
      border-color:rgba(0,212,255,.3);transform:translateY(-1px)}
    .suggestion-icon{font-size:16px}
    .suggestion-text{flex:1;font-size:14px;font-weight:500}
    .suggestion-hint{font-size:12px;color:var(--muted)}

    .quick-tags{display:flex;flex-wrap:wrap;gap:10px;padding:12px 18px}
    .tag{padding:10px 16px;border-radius:20px;background:linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid var(--outline);font-size:13px;color:#e2e8f0;cursor:pointer;transition:all .3s;
      position:relative;overflow:hidden;font-weight:600}
    .tag::before{content:'';position:absolute;inset:0;background:linear-gradient(45deg, var(--brand1), var(--brand2));opacity:0;transition:opacity .3s}
    .tag:hover{transform:translateY(-2px); box-shadow:0 10px 25px rgba(0,0,0,.3)}
    .tag:hover::before{opacity:.1}

    .timeline{display:flex;flex-direction:column;gap:16px;padding:12px 16px 120px}
    .message{border:1px solid var(--outline);background:rgba(14,18,32,.7);backdrop-filter: blur(15px);
      border-radius:24px;padding:18px;box-shadow: var(--shadow);position:relative}
    .message.ai{align-self:flex-start;max-width:95%}
    .message.user{align-self:flex-end;max-width:85%;background:linear-gradient(135deg, rgba(0,212,255,.08), rgba(139,92,246,.08));}
    .message::before{content:'';position:absolute;inset:0;border-radius:24px;background:linear-gradient(45deg, transparent, rgba(255,255,255,.02), transparent);pointer-events:none}

    .taste-card{border:1px solid var(--outline);background:rgba(15,19,35,.8);backdrop-filter: blur(15px); 
      border-radius:24px;padding:20px;box-shadow: var(--shadow);position:relative;overflow:hidden}
    .taste-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
      background:linear-gradient(90deg, var(--brand1), var(--brand2), var(--accent));opacity:.8}
    .taste-card h3{margin:0 0 12px 0;font-size:17px;font-weight:800;display:flex;align-items:center;gap:8px}
    .taste-card .desc{color:var(--muted);line-height:1.5;font-size:14px}

    .radar-section{margin-top:16px}
    .radar-wrap{position:relative;background:rgba(10,13,22,.6);border-radius:20px;padding:20px;
      border:1px solid rgba(255,255,255,.08)}
    .radar-canvas{width:100%;height:280px;border-radius:16px}
    .taste-legend{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:16px}
    .legend-item{display:flex;align-items:center;gap:8px;padding:8px 12px;
      background:rgba(255,255,255,.04);border-radius:12px;font-size:12px}
    .legend-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
    .legend-level{color:var(--muted);margin-left:auto;font-weight:600}

    .game-rec{border:1px solid var(--outline);background:rgba(15,19,35,.8);backdrop-filter: blur(15px); 
      border-radius:24px;padding:20px;box-shadow: var(--shadow);position:relative}
    .game-rec::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
      background:linear-gradient(90deg, var(--accent), var(--gold));opacity:.9}
    .game-rec h3{margin:0 0 16px 0;font-size:17px;font-weight:800;color:var(--accent)}

    /* ÊîªÁï•Âç°ÁâáÊ†∑Âºè */
    .guide-card{border:1px solid var(--outline);background:rgba(15,19,35,.8);backdrop-filter: blur(15px); 
      border-radius:24px;padding:20px;box-shadow: var(--shadow);position:relative}
    .guide-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
      background:linear-gradient(90deg, var(--brand3), var(--brand1));opacity:.9}
    .guide-card h3{margin:0 0 16px 0;font-size:17px;font-weight:800;color:var(--brand3)}

    .game-showcase{display:flex;gap:16px;align-items:flex-start}
    .game-cover{width:72px;height:72px;border-radius:16px;position:relative;overflow:hidden;
      background:linear-gradient(135deg, var(--brand2), var(--accent));display:flex;align-items:center;justify-content:center;
      box-shadow:0 15px 35px rgba(139,92,246,.3)}
    .game-cover::after{content:'üéØ';font-size:28px;filter:drop-shadow(0 2px 4px rgba(0,0,0,.3))}
    .game-info{flex:1;min-width:0}
    .game-title{font-weight:900;font-size:16px;margin-bottom:8px;color:#fff}
    .game-reason{color:var(--muted);line-height:1.5;font-size:14px;margin-bottom:14px}
    .game-actions{display:flex;gap:10px;flex-wrap:wrap}
    .btn-primary{background:linear-gradient(135deg,var(--accent),var(--gold));border:none;padding:10px 18px;
      border-radius:16px;font-weight:800;color:#0a0d16;cursor:pointer;font-size:14px;
      box-shadow:0 12px 30px rgba(255,107,107,.25);transition:all .2s}
    .btn-primary:hover{transform:translateY(-1px);box-shadow:0 16px 40px rgba(255,107,107,.35)}
    .btn-ghost{border:1px solid var(--outline);background:rgba(255,255,255,.06);padding:10px 16px;
      border-radius:16px;font-weight:700;color:#e5e7eb;cursor:pointer;font-size:14px;transition:all .2s}
    .btn-ghost:hover{background:rgba(255,255,255,.1);transform:translateY(-1px)}

    /* Âø´ÈÄüÂèçÈ¶à‰ºòÂåñ */
    .quick-feedback{border:1px solid var(--outline);background:rgba(15,19,35,.8);backdrop-filter: blur(15px); 
      border-radius:24px;padding:20px;box-shadow: var(--shadow);position:relative}
    .feedback-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
    .feedback-option{padding:12px 16px;border-radius:16px;background:linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--outline);text-align:center;cursor:pointer;transition:all .3s;font-size:13px;font-weight:600}
    .feedback-option:hover{background:linear-gradient(135deg, rgba(0,212,255,.1), rgba(139,92,246,.05));
      border-color:rgba(0,212,255,.3);transform:translateY(-2px)}
    .feedback-option.negative{border-color:rgba(255,107,107,.3)}
    .feedback-option.negative:hover{background:linear-gradient(135deg, rgba(255,107,107,.1), rgba(255,107,107,.05));
      border-color:rgba(255,107,107,.4)}

    /* Êô∫ËÉΩÂºïÂØºÊü•ËØ¢ */
    .smart-queries{margin-top:16px}
    .query-item{display:flex;align-items:center;gap:12px;padding:12px 16px;margin-bottom:8px;
      background:rgba(255,255,255,.04);border:1px solid var(--outline);border-radius:16px;
      cursor:pointer;transition:all .3s;font-size:14px}
    .query-item:hover{background:rgba(0,212,255,.08);border-color:rgba(0,212,255,.3);transform:translateX(4px)}
    .query-icon{font-size:16px;opacity:.8}
    .query-text{flex:1;font-weight:500}
    .query-arrow{color:var(--muted);font-size:12px}

    .thinking{display:inline-flex;gap:6px;align-items:center;color:var(--brand1)}
    .thinking-dot{width:6px;height:6px;border-radius:50%;background:currentColor;
      animation: pulse 1.4s infinite ease-in-out}
    .thinking-dot:nth-child(2){animation-delay:.2s}
    .thinking-dot:nth-child(3){animation-delay:.4s}
    @keyframes pulse{0%,80%,100%{transform:scale(.6);opacity:.3}40%{transform:scale(1);opacity:1}}

    .slide-in{animation:slideIn .4s ease-out forwards;opacity:0;transform:translateY(10px)}
    @keyframes slideIn{to{opacity:1;transform:translateY(0)}}

    .toast{position:fixed;top:20px;left:50%;transform:translateX(-50%);
      background:rgba(0,0,0,.8);border:1px solid var(--outline);backdrop-filter:blur(10px);
      padding:10px 16px;border-radius:12px;font-size:13px;z-index:999;font-weight:500}

    /* Èõ∑ËææÂõæÊ†∑Âºè */
    .radar-bg{fill:rgba(255,255,255,.02);stroke:rgba(255,255,255,.08);stroke-width:1}
    .radar-grid{stroke:rgba(255,255,255,.06);stroke-width:1;fill:none}
    .radar-area{fill:url(#radarGrad);stroke:rgba(0,212,255,.6);stroke-width:2;opacity:.8}
    .radar-point{fill:var(--brand1);stroke:#fff;stroke-width:2;filter:drop-shadow(0 2px 6px rgba(0,212,255,.4))}
    .radar-label{fill:#cbd5e1;font-size:11px;font-weight:600;text-anchor:middle}

    /* TabÂÜÖÂÆπÂå∫Âüü */
    .tab-content{display:none}
    .tab-content.active{display:block}
  </style>
</head>
<body>
  <div class="app">
    <div class="header">
      <div class="logo-section">
        <div class="logo"></div>
        <div>
          <div class="title">Ê∏∏ÊàèÊô∫ËÉΩÂä©Êâã</div>
          <div class="subtitle">‰∏ìÂ±ûAIÈ°æÈóÆ ¬∑ Êé®Ëçê ¬∑ ÊîªÁï• ¬∑ ‰ªòË¥πÊåáÂØº</div>
        </div>
      </div>
      
      <!-- Êñ∞Â¢ûÔºöÈ°∂ÈÉ®TabÂØºËà™ -->
      <div class="nav-tabs">
        <div class="tab active" data-tab="recommend">
          <span>üéØ</span>
          <span>Êé®Ëçê</span>
        </div>
        <div class="tab" data-tab="guide">
          <span>üìñ</span>
          <span>ÊîªÁï•</span>
        </div>
        <div class="tab" data-tab="payment">
          <span>üíé</span>
          <span>‰ªòË¥π</span>
        </div>
        <div class="tab" data-tab="chat">
          <span>üí¨</span>
          <span>Ê¥ªÂä®</span>
        </div>
      </div>
    </div>

    <!-- Êé®ËçêTabÂÜÖÂÆπ -->
    <div id="recommend-content" class="tab-content active">
      <div class="input-section">
        <div class="input-bar">
          <input id="gameInput" placeholder="ÂëäËØâÊàë‰Ω†ÊúÄËøëÂú®Áé©‰ªÄ‰πàÊ∏∏Êàè..." />
          <button class="action-btn" id="analyzeBtn">ÂàÜÊûêÊàëÁöÑÂìÅÂë≥</button>
        </div>
      </div>

      <!-- Êô∫ËÉΩÂª∫ËÆÆÊù° -->
      <div class="smart-suggestions" id="smartSuggestions">
        <div class="suggestion-item" onclick="useSmartSuggestion('ÊàëÊÉ≥Ë¶ÅÁ±ª‰ººÂéüÁ•ûÁöÑÂºÄÊîæ‰∏ñÁïåÊ∏∏Êàè')">
          <span class="suggestion-icon">üåü</span>
          <span class="suggestion-text">ÊàëÊÉ≥Ë¶ÅÁ±ª‰ººÂéüÁ•ûÁöÑÂºÄÊîæ‰∏ñÁïåÊ∏∏Êàè</span>
          <span class="suggestion-hint">‚Üí</span>
        </div>
        <div class="suggestion-item" onclick="useSmartSuggestion('Êé®ËçêÈÄÇÂêàÂíåÊúãÂèã‰∏ÄËµ∑Áé©ÁöÑÁ´ûÊäÄÊ∏∏Êàè')">
          <span class="suggestion-icon">üë•</span>
          <span class="suggestion-text">Êé®ËçêÈÄÇÂêàÂíåÊúãÂèã‰∏ÄËµ∑Áé©ÁöÑÁ´ûÊäÄÊ∏∏Êàè</span>
          <span class="suggestion-hint">‚Üí</span>
        </div>
        <div class="suggestion-item" onclick="useSmartSuggestion('ÊàëÊÉ≥ÊâæËΩªÊùæ‰ºëÈó≤ÁöÑÊâãÊ∏∏')">
          <span class="suggestion-icon">üòå</span>
          <span class="suggestion-text">ÊàëÊÉ≥ÊâæËΩªÊùæ‰ºëÈó≤ÁöÑÊâãÊ∏∏</span>
          <span class="suggestion-hint">‚Üí</span>
        </div>
      </div>

      <div class="quick-tags">
        <div class="tag" data-game="Á¨¨‰∫î‰∫∫Ê†º">Á¨¨‰∫î‰∫∫Ê†º</div>
        <div class="tag" data-game="Ëõã‰ªîÊ¥æÂØπ">Ëõã‰ªîÊ¥æÂØπ</div>
        <div class="tag" data-game="ÂÖâ¬∑ÈÅá">ÂÖâ¬∑ÈÅá</div>
        <div class="tag" data-game="ÁéãËÄÖËç£ËÄÄ">ÁéãËÄÖËç£ËÄÄ</div>
      </div>
    </div>

    <!-- ÊîªÁï•TabÂÜÖÂÆπ -->
    <div id="guide-content" class="tab-content">
      <div class="input-section">
        <div class="input-bar">
          <input id="guideInput" placeholder="ÊÉ≥Ë¶Å‰ªÄ‰πàÊ∏∏ÊàèÁöÑÊîªÁï•ÔºüÂ¶ÇÔºöÂéüÁ•ûÊñ∞ÊâãÊïôÁ®ã" />
          <button class="action-btn guide" id="guideBtn">Ëé∑ÂèñÊîªÁï•</button>
        </div>
      </div>
      <div class="quick-tags">
        <div class="tag" onclick="getGuide('ÂéüÁ•ûÊñ∞ÊâãÊîªÁï•')">ÂéüÁ•ûÊñ∞ÊâãÊîªÁï•</div>
        <div class="tag" onclick="getGuide('ÁéãËÄÖËç£ËÄÄ‰∏äÂàÜÊäÄÂ∑ß')">ÁéãËÄÖ‰∏äÂàÜÊäÄÂ∑ß</div>
        <div class="tag" onclick="getGuide('Á¨¨‰∫î‰∫∫Ê†ºÊ±ÇÁîüÊåáÂçó')">Á¨¨‰∫îÊ±ÇÁîüÊåáÂçó</div>
      </div>
    </div>

    <!-- ‰ªòË¥πÊåáÂØºTabÂÜÖÂÆπ -->
    <div id="payment-content" class="tab-content">
      <div class="input-section">
        <div class="input-bar">
          <input id="paymentInput" placeholder="Âí®ËØ¢‰ªòË¥πÂª∫ËÆÆÔºåÂ¶ÇÔºöÂéüÁ•ûÊäΩÂç°Âª∫ËÆÆ" />
          <button class="action-btn" id="paymentBtn">Âí®ËØ¢‰ªòË¥π</button>
        </div>
      </div>
      <div class="quick-tags">
        <div class="tag" onclick="getPaymentAdvice('ÂéüÁ•ûÊäΩÂç°ÊÄß‰ª∑ÊØîÂàÜÊûê')">ÂéüÁ•ûÊäΩÂç°ÂàÜÊûê</div>
        <div class="tag" onclick="getPaymentAdvice('ÁéãËÄÖËç£ËÄÄÁöÆËÇ§ÂÄº‰∏çÂÄº')">ÁéãËÄÖÁöÆËÇ§Êé®Ëçê</div>
        <div class="tag" onclick="getPaymentAdvice('ÊâãÊ∏∏ÂÖÖÂÄºÈÅøÂùëÊåáÂçó')">ÂÖÖÂÄºÈÅøÂùëÊåáÂçó</div>
      </div>
    </div>

    <!-- ËÅäÂ§©TabÂÜÖÂÆπ -->
    <div id="chat-content" class="tab-content">
      <div class="input-section">
        <div class="input-bar">
          <input id="chatInput" placeholder="ÂèÇ‰∏éÊ¥ªÂä®Â∏ÆÂä©Êàë‰ª¨ÂÅöÁöÑÊõ¥Â•Ω..." />
          <button class="action-btn" id="chatBtn">ÂèëÈÄÅÊ∂àÊÅØ</button>
        </div>
      </div>
    </div>

    <div id="conversation" class="timeline">
      <div class="message ai slide-in">
        <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px">
          <span style="font-size:20px">ü§ñ</span>
          <strong style="font-size:16px">‰Ω†ÁöÑÊ∏∏ÊàèÊô∫ËÉΩÂä©Êâã</strong>
        </div>
        <div style="color:var(--muted);line-height:1.5">
          Âó®ÔºÅÊàëÊòØ‰Ω†ÁöÑ‰∏ìÂ±ûÊ∏∏ÊàèAIÈ°æÈóÆ„ÄÇ<br>
          ÊàëÂèØ‰ª•Â∏Æ‰Ω†Ôºö<br>
          <span style="color:var(--brand1);font-weight:700">üéØ ÂàÜÊûêÂìÅÂë≥Êé®ËçêÊ∏∏Êàè</span> ¬∑
          <span style="color:var(--brand3);font-weight:700">üìñ Êèê‰æõÊ∏∏ÊàèÊîªÁï•</span> ¬∑
          <span style="color:var(--accent);font-weight:700">üíé ‰ªòË¥πÂÜ≥Á≠ñÊåáÂØº</span> ¬∑
          <span style="color:var(--gold);font-weight:700">üí¨ ÂèÇ‰∏éÊ¥ªÂä®ÔºåËÆ©‰Ω†aiÊõ¥ÊáÇ‰Ω†</span>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Ê∏∏ÊàèÊï∞ÊçÆÂ∫ì
    const gameProfiles = {
      'Á¨¨‰∫î‰∫∫Ê†º': {
        analysis: '‰Ω†ÊòØ‰∏™<span style="color:var(--accent);font-weight:700">Á≠ñÁï•ÊÄùÁª¥ËÄÖ</span>ÔºåÂñúÊ¨¢Âú®Á¥ßÂº†Âà∫ÊøÄ‰∏≠Âä®ËÑëÁ≠ãÔºå‰∫´Âèó‰∏çÂØπÁß∞Á´ûÊäÄÁöÑÂøÉÁêÜÂçöÂºà„ÄÇ‰Ω†ÂØπÊ∏∏ÊàèÁöÑ<span style="color:var(--brand1)">ÂÖ¨Âπ≥ÊÄß</span>ÂæàÂú®ÊÑèÔºåÊÑøÊÑè‰∏∫‰ºòË¥®‰ΩìÈ™å‰ªòË¥πÔºå‰ΩÜËÆ®ÂéåËøáÂ∫¶Ê∞™Èáë„ÄÇ',
        dna: {
          'Á≠ñÁï•ÊÄùËÄÉ': 95,
          'Á´ûÊäÄÂØπÊäó': 80,
          'ÊÇ¨ÁñëËß£Ë∞ú': 75,
          'Âõ¢ÈòüÂçè‰Ωú': 60,
          '‰ºëÈó≤Â®±‰πê': 30,
          'Êî∂ÈõÜÂÖªÊàê': 45
        }
      },
      'Ëõã‰ªîÊ¥æÂØπ': {
        analysis: '‰Ω†ÊòØ‰∏™<span style="color:var(--gold);font-weight:700">Âø´‰πê‰∏ª‰πâËÄÖ</span>ÔºåÈÖ∑Áà±ËΩªÊùæÊêûÊÄ™ÁöÑÂ§ö‰∫∫Ê∏∏ÊàèÔºåÂñúÊ¨¢ÂíåÊúãÂèã‰∏ÄËµ∑ÂìàÂìàÂ§ßÁ¨ë„ÄÇ‰Ω†‰∏çÂ§™Âú®‰πéËæìËµ¢ÔºåÊõ¥‰∫´ÂèóÊ∏∏ÊàèËøáÁ®ã‰∏≠ÁöÑ<span style="color:var(--brand3)">Á§æ‰∫§‰πêË∂£</span>„ÄÇ',
        dna: {
          '‰ºëÈó≤Â®±‰πê': 95,
          'Á§æ‰∫§‰∫íÂä®': 85,
          'ÂèØÁà±Ê≤ªÊÑà': 80,
          'Âõ¢ÈòüÂçè‰Ωú': 70,
          'Á´ûÊäÄÂØπÊäó': 40,
          'Á≠ñÁï•ÊÄùËÄÉ': 25
        }
      },
      'ÂÖâ¬∑ÈÅá': {
        analysis: '‰Ω†ÊòØ‰∏™<span style="color:var(--brand3);font-weight:700">ÊÉÖÊÑü‰ΩìÈ™åËÄÖ</span>ÔºåËøΩÊ±ÇÊ∏∏Êàè‰∏≠ÁöÑÁæéÊÑüÂíåÊÉÖÊÑüÂÖ±È∏£ÔºåÂñúÊ¨¢Ê∏©ÊöñÊ≤ªÊÑàÁöÑÁ§æ‰∫§‰ΩìÈ™å„ÄÇ‰Ω†Êõ¥ÁúãÈáçÊ∏∏ÊàèÁöÑ<span style="color:var(--brand2)">Ëâ∫ÊúØ‰ª∑ÂÄº</span>Ôºå‰∏çÂñúÊ¨¢ÊøÄÁÉàÁ´û‰∫â„ÄÇ',
        dna: {
          'ÂèØÁà±Ê≤ªÊÑà': 95,
          'Á§æ‰∫§‰∫íÂä®': 80,
          'Ëâ∫ÊúØÁæéÂ≠¶': 90,
          'Êé¢Á¥¢ÂÜíÈô©': 70,
          'Á´ûÊäÄÂØπÊäó': 20,
          'Á≠ñÁï•ÊÄùËÄÉ': 35
        }
      },
      'ÁéãËÄÖËç£ËÄÄ': {
        analysis: '‰Ω†ÊòØ‰∏™<span style="color:var(--accent);font-weight:700">Á´ûÊäÄ‰πãÁéã</span>ÔºåÁÉ≠Ë°∑‰∫éMOBAÁöÑÁ≠ñÁï•ÂØπÊäóÔºå‰∫´ÂèóÂõ¢ÈòüÈÖçÂêàÂáªË¥•ÂØπÊâãÁöÑÂø´ÊÑü„ÄÇ‰Ω†ÂØπÊ∏∏Êàè<span style="color:var(--brand1)">Êìç‰ΩúÊâãÊÑü</span>Ë¶ÅÊ±ÇÂæàÈ´òÔºåÊÑøÊÑèÊäïÂÖ•Êó∂Èó¥ÈíªÁ†î„ÄÇ',
        dna: {
          'Á´ûÊäÄÂØπÊäó': 95,
          'Á≠ñÁï•ÊÄùËÄÉ': 85,
          'Âõ¢ÈòüÂçè‰Ωú': 80,
          'ÊäÄÂ∑ßÊìç‰Ωú': 90,
          '‰ºëÈó≤Â®±‰πê': 30,
          'ÂèØÁà±Ê≤ªÊÑà': 15
        }
      }
    };

    const gameRecommendations = {
      'Á≠ñÁï•ÊÄùËÄÉ': [
        { name: '‰∏âÂõΩÂøó¬∑ÊàòÁï•Áâà', reason: 'Á°¨Ê†∏Á≠ñÁï•SLGÔºåÊª°Ë∂≥‰Ω†ÂØπÊ∑±Â∫¶Á≠ñÁï•ÁöÑÊ∏¥ÊúõÔºåÁúüÂÆûËøòÂéü‰∏âÂõΩ‰∫âÈú∏', icon: '‚öîÔ∏è' },
        { name: 'ÊñáÊòé6', reason: 'ÂõûÂêàÂà∂Á≠ñÁï•ÁªèÂÖ∏Ôºå‰ªéÁü≥Âô®Êó∂‰ª£Âª∫ËÆæÊñáÊòéÂ∏ùÂõΩÔºåÁ≠ñÁï•Ê∑±Â∫¶ÁàÜË°®', icon: 'üèõÔ∏è' }
      ],
      'Á´ûÊäÄÂØπÊäó': [
        { name: 'ÂíåÂπ≥Á≤æËã±', reason: 'ÊàòÊúØÁ´ûÊäÄÊ†áÊùÜÔºåÁôæ‰∫∫Á´ûÊäÄÁ¥ßÂº†Âà∫ÊøÄÔºåËÄÉÈ™å‰Ω†ÁöÑÁªºÂêàÂÆûÂäõ', icon: 'üéØ' },
        { name: 'APEXËã±ÈõÑÊâãÊ∏∏', reason: 'Ëã±ÈõÑÂ∞ÑÂáªÁ´ûÊäÄÔºåÂõ¢ÈòüÈÖçÂêà+‰∏™‰∫∫ÊäÄÂ∑ßÔºåÁ´ûÊäÄ‰ΩìÈ™åÊãâÊª°', icon: 'üöÄ' }
      ],
      '‰ºëÈó≤Â®±‰πê': [
        { name: 'ÂºÄÂøÉÊ∂àÊ∂à‰πê', reason: 'ÁªèÂÖ∏‰∏âÊ∂àÊ∏∏ÊàèÔºåÁÆÄÂçïÊòì‰∏äÊâãÔºåÁ¢éÁâáÊó∂Èó¥ÁöÑÂÆåÁæéÈÄâÊã©', icon: 'üç≠' },
        { name: 'ÊòüÈú≤Ë∞∑Áâ©ËØ≠', reason: 'Áî∞Âõ≠ÁîüÊ¥ªÊ®°ÊãüÔºåÁßçÁî∞ÈíìÈ±ºÊåñÁüøÔºåÊ≤ªÊÑàÁ≥ªfarmingÁ•û‰Ωú', icon: 'üå±' }
      ],
      'Á§æ‰∫§‰∫íÂä®': [
        { name: 'Among Us', reason: 'Â§™Á©∫Áãº‰∫∫ÊùÄÔºåÊúãÂèãËÅö‰ºöÂøÖÂ§áÔºåËÄÉÈ™åÊºîÊäÄÂíåÊé®ÁêÜËÉΩÂäõ', icon: 'üë•' },
        { name: 'QQÈ£ûËΩ¶', reason: 'Á´ûÈÄü+Á§æ‰∫§ÔºåÂíåÂ•ΩÂèã‰∏ÄËµ∑È£ôËΩ¶ÔºåËøòËÉΩÁßÄÁÇ´ÈÖ∑Êó∂Ë£Ö', icon: 'üéè' }
      ],
      'ÂèØÁà±Ê≤ªÊÑà': [
        { name: 'Êë©Â∞îÂ∫ÑÂõ≠', reason: 'Á´•Âπ¥ÂõûÂøÜÂ§çÊ¥ªÔºÅÁßçËèúÂÖªÊãâÂßÜÔºåÂíåÊúãÂèã‰∏ÄËµ∑ÈáçÊ∏©Á∫ØÁúüÊó∂ÂÖâ', icon: 'üêæ' },
        { name: 'Âä®Áâ©Ê£ÆÂèã‰ºö', reason: 'Êó†‰∫∫Â≤õÁîüÊ¥ªÊ®°ÊãüÔºåDIYË£ÖÊâÆÂÆ∂Âõ≠ÔºåË∂ÖÊ≤ªÊÑàÁöÑÊÖ¢ËäÇÂ•è‰ΩìÈ™å', icon: 'üèùÔ∏è' }
      ],
      'Êé¢Á¥¢ÂÜíÈô©': [
        { name: 'ÂéüÁ•û', reason: 'ÂºÄÊîæ‰∏ñÁïåRPGÔºå‰∏ÉÂõΩÂÜíÈô©Á≠â‰Ω†Êé¢Á¥¢ÔºåÁîªÈù¢Èü≥‰πêÈÉΩÊòØËâ∫ÊúØÂìÅÁ∫ßÂà´', icon: 'üåü' },
        { name: 'Â°ûÂ∞îËææ‰º†ËØ¥', reason: 'ÂºÄÊîæ‰∏ñÁïåÊé¢Á¥¢Ê†áÊùÜÔºåÊØè‰∏™ËßíËêΩÈÉΩÊúâÊÉäÂñúÁ≠â‰Ω†ÂèëÁé∞', icon: 'üó°Ô∏è' }
      ]
    };

    // ÊîªÁï•Êï∞ÊçÆÂ∫ì
    const gameGuides = {
      'ÂéüÁ•ûÊñ∞ÊâãÊîªÁï•': {
        title: 'ÂéüÁ•ûÊñ∞ÊâãÂÆåÂÖ®ÊåáÂçó',
        content: 'üåü <strong>Êñ∞ÊâãÂøÖÁü•Ë¶ÅÁÇπÔºö</strong><br>‚Ä¢ ‰ºòÂÖàÊèêÂçá‰∏ªCËßíËâ≤Á≠âÁ∫ßÂíåÊ≠¶Âô®<br>‚Ä¢ ÊØèÊó•ÂßîÊâòÂíå‰ΩìÂäõ‰∏çË¶ÅÊµ™Ë¥π<br>‚Ä¢ ÂâçÊúüÈáçÁÇπÂüπÂÖª‰∏Ä‰∏™ËæìÂá∫ËßíËâ≤<br>‚Ä¢ Êé¢Á¥¢Âú∞ÂõæÊî∂ÈõÜÁ•ûÁû≥ÊèêÂçá‰ΩìÂäõ<br>‚Ä¢ ÂêàÁêÜËßÑÂàíÂéüÁü≥ÔºåÈÅøÂÖç‰π±ÊäΩÂç°',
        tips: ['‰ΩìÂäõ>ÁªèÈ™å>ÊùêÊñôÁöÑ‰ºòÂÖàÁ∫ß', 'Êñ∞ÊâãÊ±†ÂøÖÊäΩÔºå‰øùÂ∫ïÂá∫5ÊòüËßíËâ≤', '‰∏ªÁ∫ø‰ªªÂä°‰ºòÂÖàÂÆåÊàê']
      },
      'ÁéãËÄÖËç£ËÄÄ‰∏äÂàÜÊäÄÂ∑ß': {
        title: 'ÁéãËÄÖ‰∏äÂàÜÊ†∏ÂøÉÊäÄÂ∑ß',
        content: '‚ö° <strong>‰∏äÂàÜÂÖ≥ÈîÆÁ≠ñÁï•Ôºö</strong><br>‚Ä¢ ‰∏ìÁ≤æ2-3‰∏™‰ΩçÁΩÆÔºå‰∏çË¶Å‰ªÄ‰πàÈÉΩÁé©<br>‚Ä¢ Â≠¶‰ºöÁúãÂ∞èÂú∞ÂõæÔºåÊÑèËØÜÊØîÊìç‰ΩúÊõ¥ÈáçË¶Å<br>‚Ä¢ Âõ¢ÊàòÁ´ô‰ΩçÔºöËæìÂá∫Èù†ÂêéÔºåÂù¶ÂÖãÂºÄÂõ¢<br>‚Ä¢ ÁªèÊµéÈ¢ÜÂÖàÊó∂Êé®Â°îÔºåÂä£ÂäøÊó∂ÂèëËÇ≤<br>‚Ä¢ Ê≤üÈÄöÂ§ß‰∫é‰∏™‰∫∫ÁßÄÔºåÈÖçÂêàÂà∂ËÉú',
        tips: ['ÈÄâÊã©Âº∫ÂäøËã±ÈõÑË∑üÁâàÊú¨', 'ÊéßÂà∂ÊÉÖÁª™ÔºåÈÅøÂÖç‰∏äÂ§¥', 'Â§çÁõòÂΩïÂÉèÊâæÈóÆÈ¢ò']
      },
      'Á¨¨‰∫î‰∫∫Ê†ºÊ±ÇÁîüÊåáÂçó': {
        title: 'Á¨¨‰∫î‰∫∫Ê†ºÊ±ÇÁîüÁßòÁ±ç',
        content: 'üîç <strong>Ê±ÇÁîüÊ†∏ÂøÉË¶ÅÈ¢ÜÔºö</strong><br>‚Ä¢ ÂºÄÂ±ÄÂàÜÊï£Ëß£ÂØÜÔºåÈÅøÂÖçÊä±Âõ¢<br>‚Ä¢ Â≠¶‰ºöÈ¢ÑÂà§ÁõëÁÆ°ËÄÖË∑ØÁ∫ø<br>‚Ä¢ ÊùøÁ™óËøûÊãõÔºåÂç°ËßÜÈáéËΩ¨ÁÇπ<br>‚Ä¢ Êïë‰∫∫Êó∂Êú∫ÔºöÁõëÁÆ°ËÄÖÁ¶ªÂºÄÂêéÂÜçÊïë<br>‚Ä¢ ÊÆãÂ±ÄÁ≠ñÁï•Ôºö‰ºòÂÖàÂºÄÈó®ÈÄÉËÑ±',
        tips: ['ÁªÉ‰π†Ëµ∞‰ΩçÂíåÁøªÁ™óÊäÄÂ∑ß', 'ÁÜüÊÇâÂú∞ÂõæÂ∏ÉÂ±Ä', 'Âõ¢ÈòüÈÖçÂêàËÉúËøá‰∏™‰∫∫ÊäÄÊúØ']
      }
    };

    // ‰ªòË¥πÂª∫ËÆÆÊï∞ÊçÆÂ∫ì
    const paymentAdvices = {
      'ÂéüÁ•ûÊäΩÂç°ÊÄß‰ª∑ÊØîÂàÜÊûê': {
        title: 'ÂéüÁ•ûÊäΩÂç°ÂÜ≥Á≠ñÊåáÂçó',
        content: 'üíé <strong>ÊäΩÂç°ÊÄß‰ª∑ÊØîÂàÜÊûêÔºö</strong><br>‚Ä¢ ÊúàÂç°ÊÄß‰ª∑ÊØîÊúÄÈ´òÔºåÂª∫ËÆÆÈïøÊúüË¥≠‰π∞<br>‚Ä¢ Â§ßÊúàÂç°ÈÄÇÂêà‰∏≠Ê∞™Áé©ÂÆ∂<br>‚Ä¢ UPËßíËâ≤Ê±†ÔºöÂº∫Âäõ‰∏ªC>ËæÖÂä©>ÈáçÂ§çËßíËâ≤<br>‚Ä¢ Ê≠¶Âô®Ê±†È£éÈô©È´òÔºåÈùûÂøÖË¶Å‰∏çÂª∫ËÆÆÊäΩ<br>‚Ä¢ È¢ÑÁïôÂéüÁü≥ÔºöÊØèÁâàÊú¨Ëá≥Â∞ë160ÊäΩ‰øùÂ∫ï',
        recommendations: ['Êñ∞ÊâãÊé®ËçêÔºöÊúàÂç°+BP', '‰∏≠Ê∞™Êé®ËçêÔºöÂ§ßÊúàÂç°+È¶ñÂÖÖÂèåÂÄç', 'Âè™ÊäΩÂñúÊ¨¢ÁöÑËßíËâ≤Ôºå‰∏çËøΩÂº∫Â∫¶']
      },
      'ÁéãËÄÖËç£ËÄÄÁöÆËÇ§ÂÄº‰∏çÂÄº': {
        title: 'ÁéãËÄÖËç£ËÄÄÁöÆËÇ§Ë¥≠‰π∞Âª∫ËÆÆ',
        content: '‚ú® <strong>ÁöÆËÇ§Ë¥≠‰π∞Á≠ñÁï•Ôºö</strong><br>‚Ä¢ ‰º†ËØ¥ÁöÆËÇ§ÔºöÁâπÊïàÂ•Ω‰ΩÜ‰ª∑Ê†ºÈ´òÔºåÁúã‰∏™‰∫∫ÂñúÂ•Ω<br>‚Ä¢ Âè≤ËØóÁöÆËÇ§ÔºöÊÄß‰ª∑ÊØîÊúÄ‰Ω≥ÔºåÂª∫ËÆÆ‰ºòÂÖàËÄÉËôë<br>‚Ä¢ ÂãáËÄÖÁöÆËÇ§Ôºö‰æøÂÆúÂÆûÁî®ÔºåÊñ∞ÊâãÂèãÂ•Ω<br>‚Ä¢ ÈôêÂÆöÁöÆËÇ§ÔºöÈîôËøáÈöæÂÜçÊúâÔºåÂñúÊ¨¢Â∞±ÂÖ•Êâã<br>‚Ä¢ Ê¥ªÂä®ÁöÆËÇ§ÔºöÈÄöËøá‰ªªÂä°Ëé∑ÂæóÔºåÊúÄÂàíÁÆó',
        recommendations: ['‰ºòÂÖà‰π∞Â∏∏Áî®Ëã±ÈõÑÁöÑÁöÆËÇ§', 'Á≠âÊäòÊâ£Ê¥ªÂä®ÂÜçË¥≠‰π∞', 'ÁöÆËÇ§‰∏çÂΩ±ÂìçÊ∏∏ÊàèÂπ≥Ë°°']
      },
      'ÊâãÊ∏∏ÂÖÖÂÄºÈÅøÂùëÊåáÂçó': {
        title: 'ÊâãÊ∏∏ÂÖÖÂÄºÈò≤ÂùëÊîªÁï•',
        content: '‚ö†Ô∏è <strong>ÂÖÖÂÄºÂâçÂøÖÁúãÔºö</strong><br>‚Ä¢ ËÆæÂÆöÊúàÂ∫¶È¢ÑÁÆóÔºåÈÅøÂÖçÂÜ≤Âä®Ê∂àË¥π<br>‚Ä¢ È¶ñÂÖÖÁ§ºÂåÖÈÄöÂ∏∏ÊÄß‰ª∑ÊØîÊúÄÈ´ò<br>‚Ä¢ ÈÅøÂºÄÊäΩÂç°Á±ª"ËµåÂçö"Êú∫Âà∂<br>‚Ä¢ ‰ºòÂÖàË¥≠‰π∞ËÉΩÁõ¥Êé•ÊèêÂçá‰ΩìÈ™åÁöÑÂÜÖÂÆπ<br>‚Ä¢ ÂÖ≥Ê≥®ÈÄÄÊ¨æÊîøÁ≠ñÂíåÂÆ¢ÊúçÂìçÂ∫î<br>‚Ä¢ Êú™ÊàêÂπ¥‰∫∫ÈúÄÂÆ∂ÈïøÁõëÁù£',
        recommendations: ['ÁêÜÊÄßÊ∂àË¥πÔºåÈáèÂäõËÄåË°å', '‰ºòÈÄâ‰π∞Êñ≠Âà∂Ê∏∏Êàè', 'Ë≠¶ÊÉïËØ±ÂØºÂÖÖÂÄºÂ•óË∑Ø']
      }
    };

    // ÂΩìÂâçÊøÄÊ¥ªÁöÑtab
    let currentTab = 'recommend';

    // DOMÂÖÉÁ¥†
    const conversation = document.getElementById('conversation');
    const gameInput = document.getElementById('gameInput');
    const analyzeBtn = document.getElementById('analyzeBtn');
    const guideInput = document.getElementById('guideInput');
    const guideBtn = document.getElementById('guideBtn');
    const paymentInput = document.getElementById('paymentInput');
    const paymentBtn = document.getElementById('paymentBtn');
    const chatInput = document.getElementById('chatInput');
    const chatBtn = document.getElementById('chatBtn');
    const smartSuggestions = document.getElementById('smartSuggestions');

    // Â∑•ÂÖ∑ÂáΩÊï∞
    function addMessage(content, type = 'ai') {
      const msg = document.createElement('div');
      msg.className = `message ${type} slide-in`;
      msg.innerHTML = content;
      conversation.appendChild(msg);
      msg.scrollIntoView({ behavior: 'smooth', block: 'end' });
      return msg;
    }

    function showToast(text, type = 'info') {
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = text;
      if (type === 'success') {
        toast.style.background = 'rgba(16,185,129,0.2)';
        toast.style.borderColor = 'rgba(16,185,129,0.4)';
      }
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 2000);
    }

    // TabÂàáÊç¢ÂäüËÉΩ
    function switchTab(tabName) {
      // Êõ¥Êñ∞tabÊøÄÊ¥ªÁä∂ÊÄÅ
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
      
      // Êõ¥Êñ∞ÂÜÖÂÆπÂå∫Âüü
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      document.getElementById(`${tabName}-content`).classList.add('active');
      
      currentTab = tabName;

      // Ê†πÊçÆtabÊòæÁ§∫‰∏çÂêåÁöÑÊô∫ËÉΩÂª∫ËÆÆ
      updateSmartSuggestions(tabName);
    }

    // Êõ¥Êñ∞Êô∫ËÉΩÂª∫ËÆÆ
    function updateSmartSuggestions(tabName) {
      const suggestions = {
        recommend: [
          { icon: 'üåü', text: 'ÊàëÊÉ≥Ë¶ÅÁ±ª‰ººÂéüÁ•ûÁöÑÂºÄÊîæ‰∏ñÁïåÊ∏∏Êàè', query: 'ÊàëÊÉ≥Ë¶ÅÁ±ª‰ººÂéüÁ•ûÁöÑÂºÄÊîæ‰∏ñÁïåÊ∏∏Êàè' },
          { icon: 'üë•', text: 'Êé®ËçêÈÄÇÂêàÂíåÊúãÂèã‰∏ÄËµ∑Áé©ÁöÑÁ´ûÊäÄÊ∏∏Êàè', query: 'Êé®ËçêÈÄÇÂêàÂíåÊúãÂèã‰∏ÄËµ∑Áé©ÁöÑÁ´ûÊäÄÊ∏∏Êàè' },
          { icon: 'üòå', text: 'ÊàëÊÉ≥ÊâæËΩªÊùæ‰ºëÈó≤ÁöÑÊâãÊ∏∏', query: 'ÊàëÊÉ≥ÊâæËΩªÊùæ‰ºëÈó≤ÁöÑÊâãÊ∏∏' }
        ],
        guide: [
          { icon: 'üìö', text: 'ÂéüÁ•ûÊñ∞ÊâãÊÄé‰πàÂø´ÈÄüÂçáÁ∫ßÔºü', query: 'ÂéüÁ•ûÊñ∞ÊâãÊÄé‰πàÂø´ÈÄüÂçáÁ∫ßÔºü' },
          { icon: 'üéØ', text: 'ÁéãËÄÖËç£ËÄÄÊÄé‰πàÂø´ÈÄü‰∏äÂàÜÔºü', query: 'ÁéãËÄÖËç£ËÄÄÊÄé‰πàÂø´ÈÄü‰∏äÂàÜÔºü' },
          { icon: 'üîç', text: 'Á¨¨‰∫î‰∫∫Ê†ºÊ±ÇÁîüÊäÄÂ∑ßÂàÜ‰∫´', query: 'Á¨¨‰∫î‰∫∫Ê†ºÊ±ÇÁîüÊäÄÂ∑ßÂàÜ‰∫´' }
        ],
        payment: [
          { icon: 'üí∞', text: 'ÂéüÁ•ûÊúàÂç°ÂíåÂ§ßÊúàÂç°Âì™‰∏™ÂàíÁÆóÔºü', query: 'ÂéüÁ•ûÊúàÂç°ÂíåÂ§ßÊúàÂç°Âì™‰∏™ÂàíÁÆóÔºü' },
          { icon: '‚ú®', text: 'ÁéãËÄÖËç£ËÄÄÁöÆËÇ§ÂÄº‰∏çÂÄºÂæó‰π∞Ôºü', query: 'ÁéãËÄÖËç£ËÄÄÁöÆËÇ§ÂÄº‰∏çÂÄºÂæó‰π∞Ôºü' },
          { icon: '‚ö†Ô∏è', text: 'ÊâãÊ∏∏ÂÖÖÂÄºÊúâ‰ªÄ‰πàÊ≥®ÊÑè‰∫ãÈ°πÔºü', query: 'ÊâãÊ∏∏ÂÖÖÂÄºÊúâ‰ªÄ‰πàÊ≥®ÊÑè‰∫ãÈ°πÔºü' }
        ],
        chat: [
          { icon: 'üí¨', text: 'ÊúÄËøëÊúâ‰ªÄ‰πàÂ•ΩÁé©ÁöÑÊñ∞Ê∏∏ÊàèÂêóÔºü', query: 'ÊúÄËøëÊúâ‰ªÄ‰πàÂ•ΩÁé©ÁöÑÊñ∞Ê∏∏ÊàèÂêóÔºü' },
          { icon: 'üéÆ', text: '‰Ω†ËßâÂæóÊâãÊ∏∏ÂíåÁ´ØÊ∏∏Âì™‰∏™Êõ¥Â•ΩÔºü', query: '‰Ω†ËßâÂæóÊâãÊ∏∏ÂíåÁ´ØÊ∏∏Âì™‰∏™Êõ¥Â•ΩÔºü' },
          { icon: 'ü§î', text: 'Ê∏∏ÊàèÂÖÖÈí±ÁúüÁöÑËÉΩÂèòÂº∫ÂêóÔºü', query: 'Ê∏∏ÊàèÂÖÖÈí±ÁúüÁöÑËÉΩÂèòÂº∫ÂêóÔºü' }
        ]
      };

      const tabSuggestions = suggestions[tabName] || suggestions.recommend;
      smartSuggestions.innerHTML = tabSuggestions.map(item => `
        <div class="suggestion-item" onclick="useSmartSuggestion('${item.query}')">
          <span class="suggestion-icon">${item.icon}</span>
          <span class="suggestion-text">${item.text}</span>
          <span class="suggestion-hint">‚Üí</span>
        </div>
      `).join('');
    }

    // ‰ΩøÁî®Êô∫ËÉΩÂª∫ËÆÆ
    function useSmartSuggestion(query) {
      const currentInput = getCurrentInput();
      if (currentInput) {
        currentInput.value = query;
        triggerCurrentAction();
      }
      smartSuggestions.classList.remove('show');
    }

    // Ëé∑ÂèñÂΩìÂâçÊøÄÊ¥ªÁöÑËæìÂÖ•Ê°Ü
    function getCurrentInput() {
      switch(currentTab) {
        case 'recommend': return gameInput;
        case 'guide': return guideInput;
        case 'payment': return paymentInput;
        case 'chat': return chatInput;
        default: return gameInput;
      }
    }

    // Ëß¶ÂèëÂΩìÂâçtabÁöÑÊìç‰Ωú
    function triggerCurrentAction() {
      switch(currentTab) {
        case 'recommend': analyzeGame(); break;
        case 'guide': getGameGuide(); break;
        case 'payment': getPaymentAdvice(); break;
        case 'chat': sendChatMessage(); break;
      }
    }

    // Ê∏≤ÊüìÁî®Êà∑ÁîªÂÉèÂç°Áâá
    function renderTasteProfile(game, profile) {
      return `
        <div class="taste-card">
          <h3>üß¨ ‰Ω†ÁöÑÊ∏∏ÊàèDNAËß£ËØª</h3>
          <div class="desc">${profile.analysis}</div>
          ${renderRadarChart(profile.dna)}
        </div>
      `;
    }

    // Ê∏≤ÊüìÈõ∑ËææÂõæ
    function renderRadarChart(dna) {
      const chartId = `radar_${Date.now()}`;
      return `
        <div class="radar-section">
          <div class="radar-wrap">
            <svg id="${chartId}" class="radar-canvas" viewBox="0 0 300 280">
              <defs>
                <radialGradient id="radarGrad" cx="50%" cy="50%" r="50%">
                  <stop offset="0%" style="stop-color:rgba(0,212,255,0.3)"/>
                  <stop offset="100%" style="stop-color:rgba(139,92,246,0.1)"/>
                </radialGradient>
              </defs>
            </svg>
            <div class="taste-legend">
              ${Object.entries(dna).map(([key, value], index) => `
                <div class="legend-item">
                  <div class="legend-dot" style="background: hsl(${index * 60}, 70%, 60%)"></div>
                  <span>${key}</span>
                  <span class="legend-level">${value}%</span>
                </div>
              `).join('')}
            </div>
          </div>
        </div>
      `;
    }

    // ÁªòÂà∂Èõ∑ËææÂõæ
    function drawRadarChart(chartId, dna) {
      const svg = document.getElementById(chartId);
      if (!svg) return;

      const center = { x: 150, y: 140 };
      const maxRadius = 100;
      const categories = Object.keys(dna);
      const values = Object.values(dna);
      const angleStep = (2 * Math.PI) / categories.length;

      svg.innerHTML = svg.innerHTML;

      for (let i = 1; i <= 5; i++) {
        const radius = (maxRadius / 5) * i;
        const points = categories.map((_, index) => {
          const angle = angleStep * index - Math.PI / 2;
          const x = center.x + Math.cos(angle) * radius;
          const y = center.y + Math.sin(angle) * radius;
          return `${x},${y}`;
        }).join(' ');
        
        const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
        polygon.setAttribute('points', points);
        polygon.setAttribute('class', 'radar-bg');
        polygon.style.fill = i === 5 ? 'rgba(255,255,255,0.02)' : 'none';
        polygon.style.stroke = 'rgba(255,255,255,0.06)';
        svg.appendChild(polygon);
      }

      categories.forEach((_, index) => {
        const angle = angleStep * index - Math.PI / 2;
        const x = center.x + Math.cos(angle) * maxRadius;
        const y = center.y + Math.sin(angle) * maxRadius;
        
        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        line.setAttribute('x1', center.x);
        line.setAttribute('y1', center.y);
        line.setAttribute('x2', x);
        line.setAttribute('y2', y);
        line.setAttribute('class', 'radar-grid');
        svg.appendChild(line);
      });

      const dataPoints = values.map((value, index) => {
        const angle = angleStep * index - Math.PI / 2;
        const radius = (value / 100) * maxRadius;
        const x = center.x + Math.cos(angle) * radius;
        const y = center.y + Math.sin(angle) * radius;
        return `${x},${y}`;
      }).join(' ');

      const dataPolygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
      dataPolygon.setAttribute('points', dataPoints);
      dataPolygon.setAttribute('class', 'radar-area');
      svg.appendChild(dataPolygon);

      values.forEach((value, index) => {
        const angle = angleStep * index - Math.PI / 2;
        const radius = (value / 100) * maxRadius;
        const x = center.x + Math.cos(angle) * radius;
        const y = center.y + Math.sin(angle) * radius;
        
        const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
        circle.setAttribute('cx', x);
        circle.setAttribute('cy', y);
        circle.setAttribute('r', 4);
        circle.setAttribute('class', 'radar-point');
        svg.appendChild(circle);
      });

      categories.forEach((category, index) => {
        const angle = angleStep * index - Math.PI / 2;
        const labelRadius = maxRadius + 20;
        const x = center.x + Math.cos(angle) * labelRadius;
        const y = center.y + Math.sin(angle) * labelRadius;
        
        const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        text.setAttribute('x', x);
        text.setAttribute('y', y + 4);
        text.setAttribute('class', 'radar-label');
        text.textContent = category;
        svg.appendChild(text);
      });
    }

    // ÁîüÊàêÊ∏∏ÊàèÊé®Ëçê
    function generateRecommendation(dna) {
      const sortedTraits = Object.entries(dna)
        .sort(([,a], [,b]) => b - a)
        .slice(0, 2);
      
      const primaryTrait = sortedTraits[0][0];
      const recs = gameRecommendations[primaryTrait] || gameRecommendations['‰ºëÈó≤Â®±‰πê'];
      const selectedGame = recs[Math.floor(Math.random() * recs.length)];
      
      return selectedGame;
    }

    // Ê∏≤ÊüìÊé®ËçêÂç°Áâá
    function renderRecommendation(game) {
      return `
        <div class="game-rec">
          <h3>üéØ ‰∏∫‰Ω†Á≤æÈÄâÊé®Ëçê</h3>
          <div class="game-showcase">
            <div class="game-cover">
              <div style="font-size: 24px;">${game.icon}</div>
            </div>
            <div class="game-info">
              <div class="game-title">${game.name}</div>
              <div class="game-reason">${game.reason}</div>
              <div class="game-actions">
                <button class="btn-primary" onclick="openGame('${game.name}')">Á´ãÂç≥‰ΩìÈ™å</button>
                <button class="btn-ghost" onclick="saveGame('${game.name}')">Âä†ÂÖ•ÂøÉÊÑøÂçï</button>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // Ê∏≤ÊüìÂø´ÈÄüÂèçÈ¶à - ‰ºòÂåñÁâà
    function renderQuickFeedback() {
      return `
        <div class="quick-feedback">
          <h3>üí≠ Ëøô‰∏™Êé®ËçêÊÄé‰πàÊ†∑Ôºü</h3>
          <div class="feedback-grid">
            <div class="feedback-option" onclick="handlePositiveFeedback()">
              <div style="font-size:18px;margin-bottom:4px">üéâ</div>
              <div>ÂæàÂêàÊàëÂè£Âë≥</div>
            </div>
            <div class="feedback-option negative" onclick="showSmartQueries()">
              <div style="font-size:18px;margin-bottom:4px">ü§î</div>
              <div>‰∏çÂ§™ÂØπË∑Ø</div>
            </div>
          </div>
        </div>
      `;
    }

    // Êô∫ËÉΩÊü•ËØ¢ÂºïÂØº - Èôç‰ΩéÊìç‰ΩúÊàêÊú¨
    function renderSmartQueries() {
      const queries = [
        { icon: 'üéÆ', text: 'ÊÉ≥Ë¶ÅÊõ¥‰ºëÈó≤ËΩªÊùæÁöÑÊ∏∏Êàè', query: 'ÊàëÊÉ≥Ë¶ÅÊõ¥‰ºëÈó≤ËΩªÊùæÁöÑÊ∏∏ÊàèÁ±ªÂûã' },
        { icon: '‚ö°', text: 'Â∏åÊúõËäÇÂ•èÊõ¥Âø´Êõ¥Âà∫ÊøÄ', query: 'Êé®ËçêËäÇÂ•èÊõ¥Âø´Êõ¥Âà∫ÊøÄÁöÑÊ∏∏Êàè' },
        { icon: 'üë•', text: 'ÊÉ≥Ë¶ÅÂ§ö‰∫∫Á§æ‰∫§Á±ªÊ∏∏Êàè', query: 'ÊàëÊÉ≥Ë¶ÅÈÄÇÂêàÂíåÊúãÂèã‰∏ÄËµ∑Áé©ÁöÑÁ§æ‰∫§Ê∏∏Êàè' },
        { icon: 'üß©', text: 'ÂÅèÁà±Á≠ñÁï•Ëß£Ë∞úÁ±ªÊ∏∏Êàè', query: 'Êé®ËçêÁ≠ñÁï•ÊÄßÂº∫ÊàñËß£Ë∞úÁ±ªÁöÑÊ∏∏Êàè' },
        { icon: 'üí∞', text: 'Â∏åÊúõÊòØÂÖçË¥πÊàñ‰Ωé‰ªòË¥πÊ∏∏Êàè', query: 'Êé®ËçêÂÖçË¥πÊàñ‰ªòË¥πËæÉÂ∞ëÁöÑÊ∏∏Êàè' },
        { icon: 'üé®', text: 'Êõ¥Âú®ÊÑèÊ∏∏ÊàèÁîªÈù¢ÂíåÈü≥‰πê', query: 'Êé®ËçêÁîªÈù¢Á≤æÁæéÈü≥‰πêÂ•ΩÂê¨ÁöÑÊ∏∏Êàè' }
      ];

      return `
        <div class="taste-card">
          <h3>üéØ ÂëäËØâÊàë‰Ω†Êõ¥ÂÖ∑‰ΩìÁöÑÊÉ≥Ê≥ï</h3>
          <div class="desc" style="margin-bottom:16px">ÁÇπÂáª‰∏ãÈù¢ÊúÄÁ¨¶Âêà‰Ω†ÊÉ≥Ê≥ïÁöÑÈÄâÈ°πÔºåÊàëÊù•ÈáçÊñ∞‰∏∫‰Ω†Êé®ËçêÔºö</div>
          <div class="smart-queries">
            ${queries.map(item => `
              <div class="query-item" onclick="refineWithQuery('${item.query}')">
                <span class="query-icon">${item.icon}</span>
                <span class="query-text">${item.text}</span>
                <span class="query-arrow">‚Üí</span>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }

    // Ê∏≤ÊüìÊîªÁï•Âç°Áâá
    function renderGuideCard(guide) {
      return `
        <div class="guide-card">
          <h3>üìñ ${guide.title}</h3>
          <div class="desc">${guide.content}</div>
          ${guide.tips ? `
            <div style="margin-top:16px">
              <div style="font-weight:700;margin-bottom:8px;color:var(--brand3)">üí° ÂÆûÁî®Â∞èË¥¥Â£´Ôºö</div>
              ${guide.tips.map(tip => `<div style="color:var(--muted);font-size:13px;margin-bottom:4px">‚Ä¢ ${tip}</div>`).join('')}
            </div>
          ` : ''}
          <div class="game-actions" style="margin-top:16px">
            <button class="btn-primary" onclick="getMoreGuides('${guide.title}')">Êü•ÁúãÊõ¥Â§öÊîªÁï•</button>
            <button class="btn-ghost" onclick="saveGuide('${guide.title}')">Êî∂ËóèÊîªÁï•</button>
          </div>
        </div>
      `;
    }

    // Ê∏≤Êüì‰ªòË¥πÂª∫ËÆÆÂç°Áâá
    function renderPaymentCard(advice) {
      return `
        <div class="taste-card" style="border-top: 2px solid var(--gold)">
          <h3>üíé ${advice.title}</h3>
          <div class="desc">${advice.content}</div>
          ${advice.recommendations ? `
            <div style="margin-top:16px">
              <div style="font-weight:700;margin-bottom:8px;color:var(--gold)">üí∞ ‰∏ì‰∏öÂª∫ËÆÆÔºö</div>
              ${advice.recommendations.map(rec => `<div style="color:var(--muted);font-size:13px;margin-bottom:4px">‚Ä¢ ${rec}</div>`).join('')}
            </div>
          ` : ''}
        </div>
      `;
    }

    // ‰∏ªË¶ÅÂäüËÉΩÂáΩÊï∞
    function analyzeGame() {
      const gameName = gameInput.value.trim();
      if (!gameName) {
        smartSuggestions.classList.add('show');
        showToast('ÈÄâÊã©‰∏äÊñπÂª∫ËÆÆÊàñÂëäËØâÊàë‰Ω†Âú®Áé©ÁöÑÊ∏∏Êàè üòä');
        return;
      }

      addMessage(`ÊàëÊúÄËøëÂú®Áé©Ôºö<strong>${gameName}</strong>`, 'user');
      smartSuggestions.classList.remove('show');

      const thinkingMsg = addMessage(`
        <div class="thinking">
          <span>Ê≠£Âú®ÂàÜÊûê‰Ω†ÁöÑÊ∏∏ÊàèÂìÅÂë≥</span>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
        </div>
      `);

      setTimeout(() => {
        thinkingMsg.remove();
        
        const profile = gameProfiles[gameName] || gameProfiles['Á¨¨‰∫î‰∫∫Ê†º'];
        const profileMsg = addMessage(renderTasteProfile(gameName, profile));
        
        setTimeout(() => {
          const chartId = profileMsg.querySelector('svg').id;
          drawRadarChart(chartId, profile.dna);
        }, 100);

        setTimeout(() => {
          const recommendation = generateRecommendation(profile.dna);
          addMessage(renderRecommendation(recommendation));
          
          setTimeout(() => {
            addMessage(renderQuickFeedback());
          }, 800);
        }, 1200);
        
      }, 2000);

      gameInput.value = '';
    }

    function getGameGuide() {
      const query = guideInput.value.trim();
      if (!query) {
        smartSuggestions.classList.add('show');
        showToast('ÂëäËØâÊàë‰Ω†ÈúÄË¶Å‰ªÄ‰πàÊ∏∏ÊàèÁöÑÊîªÁï• üìñ');
        return;
      }

      addMessage(`ÊàëÊÉ≥‰∫ÜËß£Ôºö<strong>${query}</strong>`, 'user');
      smartSuggestions.classList.remove('show');

      const thinkingMsg = addMessage(`
        <div class="thinking">
          <span>Ê≠£Âú®‰∏∫‰Ω†Êï¥ÁêÜÊîªÁï•</span>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
        </div>
      `);

      setTimeout(() => {
        thinkingMsg.remove();
        
        // Êü•ÊâæÂåπÈÖçÁöÑÊîªÁï•
        const matchedGuide = Object.entries(gameGuides).find(([key]) => 
          query.includes(key) || key.includes(query)
        );
        
        const guide = matchedGuide ? matchedGuide[1] : {
          title: '‰∏∫‰Ω†ÂÆöÂà∂ÁöÑÊîªÁï•Âª∫ËÆÆ',
          content: `Âü∫‰∫é‰Ω†ÁöÑÈóÆÈ¢ò"${query}"ÔºåÊàëÂª∫ËÆÆÔºö<br>‚Ä¢ ÂÖà‰∫ÜËß£Ê∏∏ÊàèÂü∫Á°ÄÊú∫Âà∂ÂíåÊìç‰Ωú<br>‚Ä¢ ËßÇÁúãÁõ∏ÂÖ≥Ê∏∏ÊàèËßÜÈ¢ëÊïôÁ®ã<br>‚Ä¢ Âä†ÂÖ•Ê∏∏ÊàèÂÆòÊñπÁæ§ÊàñËÆ∫Âùõ‰∫§ÊµÅ<br>‚Ä¢ ‰ªéÁÆÄÂçïÊ®°ÂºèÂºÄÂßãÁªÉ‰π†<br>‚Ä¢ Â§öÂÆûÊàòÊÄªÁªìÁªèÈ™å`,
          tips: ['ËÄêÂøÉÁªÉ‰π†ÊòØÊèêÂçáÁöÑÂÖ≥ÈîÆ', 'ÂêëÈ´òÊâãÂ≠¶‰π†‰ΩÜ‰∏çÁõ≤ÁõÆÊ®°‰ªø', '‰øùÊåÅËâØÂ•ΩÁöÑÊ∏∏ÊàèÂøÉÊÄÅ']
        };
        
        addMessage(renderGuideCard(guide));
      }, 1500);

      guideInput.value = '';
    }

    function getPaymentAdvice() {
      const query = paymentInput.value.trim();
      if (!query) {
        smartSuggestions.classList.add('show');
        showToast('ÂëäËØâÊàë‰Ω†ÊÉ≥Âí®ËØ¢ÁöÑ‰ªòË¥πÈóÆÈ¢ò üíé');
        return;
      }

      addMessage(`ÊàëÊÉ≥Âí®ËØ¢Ôºö<strong>${query}</strong>`, 'user');
      smartSuggestions.classList.remove('show');

      const thinkingMsg = addMessage(`
        <div class="thinking">
          <span>Ê≠£Âú®ÂàÜÊûê‰ªòË¥πÊÄß‰ª∑ÊØî</span>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
        </div>
      `);

      setTimeout(() => {
        thinkingMsg.remove();
        
        const matchedAdvice = Object.entries(paymentAdvices).find(([key]) => 
          query.includes(key) || key.includes(query)
        );
        
        const advice = matchedAdvice ? matchedAdvice[1] : {
          title: '‰∏™ÊÄßÂåñ‰ªòË¥πÂª∫ËÆÆ',
          content: `ÂÖ≥‰∫é"${query}"ÁöÑ‰ªòË¥πÂª∫ËÆÆÔºö<br>‚Ä¢ È¶ñÂÖàËØÑ‰º∞Ëøô‰∏™Ê∂àË¥πÊòØÂê¶ÂøÖË¶Å<br>‚Ä¢ ÂØπÊØî‰∏çÂêåÊ∏†ÈÅìÁöÑ‰ª∑Ê†ºÂíå‰ºòÊÉ†<br>‚Ä¢ ËÄÉËôëÈïøÊúü‰ª∑ÂÄºËÄåÈùûÁü≠ÊúüÂø´ÊÑü<br>‚Ä¢ ËÆæÂÆöÂêàÁêÜÁöÑÊúàÂ∫¶Ê∏∏ÊàèÈ¢ÑÁÆó<br>‚Ä¢ ‰ºòÂÖàË¥≠‰π∞ËÉΩÈïøÊúüÂèóÁõäÁöÑÂÜÖÂÆπ`,
          recommendations: ['ÁêÜÊÄßÊ∂àË¥πÔºåÈÅøÂÖçÂÜ≤Âä®Ë¥≠‰π∞', 'ÂÖ≥Ê≥®ÂÆòÊñπÊ¥ªÂä®ÂíåÊäòÊâ£', 'ÂèØ‰ª•Á≠âÂæÖÊõ¥Â•ΩÁöÑÊó∂Êú∫']
        };
        
        addMessage(renderPaymentCard(advice));
      }, 1500);

      paymentInput.value = '';
    }

    function sendChatMessage() {
      const message = chatInput.value.trim();
      if (!message) {
        smartSuggestions.classList.add('show');
        showToast('Èöè‰æøËÅäËÅäÊ∏∏ÊàèÁõ∏ÂÖ≥ÁöÑËØùÈ¢òÂêß üí¨');
        return;
      }

      addMessage(`${message}`, 'user');
      smartSuggestions.classList.remove('show');

      const thinkingMsg = addMessage(`
        <div class="thinking">
          <span>Ê≠£Âú®ÊÄùËÄÉÂõûÂ§ç</span>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
        </div>
      `);

      setTimeout(() => {
        thinkingMsg.remove();
        
        // ÁÆÄÂçïÁöÑËÅäÂ§©ÂõûÂ§çÈÄªËæë
        let response = '';
        if (message.includes('Êé®Ëçê') || message.includes('Â•ΩÁé©')) {
          response = 'üéÆ ÂÖ≥‰∫éÊ∏∏ÊàèÊé®ËçêÔºåÊàëËßâÂæóÊúÄÈáçË¶ÅÁöÑÊòØÊâæÂà∞ÈÄÇÂêà‰Ω†ÁöÑÁ±ªÂûãÔºÅ‰Ω†ÊØîËæÉÂñúÊ¨¢‰ªÄ‰πàÈ£éÊ†ºÁöÑÊ∏∏ÊàèÂë¢ÔºüÊØîÂ¶ÇÁ´ûÊäÄ„ÄÅ‰ºëÈó≤„ÄÅÁ≠ñÁï•ËøòÊòØËßíËâ≤ÊâÆÊºîÔºü';
        } else if (message.includes('ÂÖÖÂÄº') || message.includes('Ê∞™Èáë')) {
          response = 'üí∞ ÂÖ≥‰∫éÊ∏∏ÊàèÊ∂àË¥πÔºåÊàëÁöÑÂª∫ËÆÆÊòØÁêÜÊÄß‰∏∫‰∏ª„ÄÇÂèØ‰ª•ÂÖà‰ΩìÈ™åÂÖçË¥πÂÜÖÂÆπÔºåÁ°ÆÂÆûÂñúÊ¨¢ÂÜçËÄÉËôëÈÄÇÂ∫¶ÊîØÊåÅ„ÄÇËÆ∞‰ΩèÊ∏∏ÊàèÊòØ‰∏∫‰∫ÜÂø´‰πêÔºå‰∏çË¶ÅËÆ©‰ªòË¥πÊàê‰∏∫Ë¥üÊãÖÂì¶ÔºÅ';
        } else if (message.includes('ÊâãÊ∏∏') || message.includes('Á´ØÊ∏∏')) {
          response = 'üì± ÊâãÊ∏∏ÂíåÁ´ØÊ∏∏ÂêÑÊúâ‰ºòÂäøÂë¢ÔºÅÊâãÊ∏∏Êñπ‰æøÈöèÊó∂ÈöèÂú∞Áé©ÔºåÁ´ØÊ∏∏‰ΩìÈ™åÊõ¥‰∏∞ÂØåÊ∑±Â∫¶Êõ¥È´ò„ÄÇ‰Ω†Âπ≥Êó∂Êõ¥ÂñúÊ¨¢Âì™ÁßçÊ∏∏ÊàèÂπ≥Âè∞Ôºü';
        } else {
          response = `üòä ÂìàÂìàÔºåÂÖ≥‰∫é"${message}"Ëøô‰∏™ËØùÈ¢òÂæàÊúâË∂£ÔºÅ‰Ωú‰∏∫Ê∏∏ÊàèÂä©ÊâãÔºåÊàëÂæà‰πêÊÑèÂíå‰Ω†ËÅäÊ∏∏Êàè„ÄÇ‰Ω†ËøòÊÉ≥‰∫ÜËß£‰ªÄ‰πàÊ∏∏ÊàèÁõ∏ÂÖ≥ÁöÑÂÜÖÂÆπÂêóÔºüÊàëÂèØ‰ª•Â∏Æ‰Ω†Êé®Ëçê„ÄÅÊèê‰æõÊîªÁï•ÊàñËÄÖ‰ªòË¥πÂª∫ËÆÆÂì¶ÔºÅ`;
        }
        
        addMessage(response);
      }, 1000);

      chatInput.value = '';
    }

    // ÂèçÈ¶àÂ§ÑÁêÜÂáΩÊï∞
    function handlePositiveFeedback() {
      addMessage(`
        <div class="taste-card" style="border-top: 2px solid var(--brand3)">
          <h3>üéâ Â§™Ê£í‰∫ÜÔºÅ</h3>
          <div class="desc" style="color: var(--brand3);">
            ÊàëÂ∑≤ÁªèËÆ∞‰Ωè‰∫Ü‰Ω†ÁöÑÂñúÂ•ΩÔºå‰∏ãÊ¨°Êé®Ëçê‰ºöÊõ¥Á≤æÂáÜ„ÄÇ<br>
            <strong>ÁªßÁª≠ÂëäËØâÊàëÂÖ∂‰ªñÊ∏∏ÊàèÔºåËÆ©ÊàëÊõ¥ÊáÇ‰Ω†ÁöÑÂìÅÂë≥ÂêßÔºÅ</strong>
          </div>
        </div>
      `);
      showToast('Â∑≤ËÆ∞ÂΩï‰Ω†ÁöÑÂñúÂ•ΩÂÅèÂêë ‚ú®', 'success');
    }

    function showSmartQueries() {
      addMessage(renderSmartQueries());
    }

    function refineWithQuery(query) {
      addMessage(`ÊàëÁöÑÂÖ∑‰ΩìÈúÄÊ±ÇÔºö<strong>${query}</strong>`, 'user');
      
      const thinkingMsg = addMessage(`
        <div class="thinking">
          <span>Âü∫‰∫é‰Ω†ÁöÑÈúÄÊ±ÇÈáçÊñ∞ÂàÜÊûê</span>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
        </div>
      `);

      setTimeout(() => {
        thinkingMsg.remove();
        
        // Ê†πÊçÆÂÖ∑‰ΩìÈúÄÊ±ÇÁîüÊàêÂÆöÂà∂Êé®Ëçê
        let customGame = {
          name: 'ÈáèË∫´ÂÆöÂà∂Êé®Ëçê',
          reason: 'Âü∫‰∫é‰Ω†ÁöÑÂÖ∑‰ΩìÈúÄÊ±ÇÁ≤æÂøÉÊåëÈÄâ',
          icon: '‚ú®'
        };

        if (query.includes('‰ºëÈó≤ËΩªÊùæ')) {
          customGame = {
            name: 'ÂºÄÂøÉÊ∂àÊ∂à‰πê',
            reason: 'ÁªèÂÖ∏‰∏âÊ∂àÊ∏∏ÊàèÔºåÊìç‰ΩúÁÆÄÂçïÔºåÈöèÊó∂ÂèØÁé©ÂèØÂÅúÔºåÂÆåÁæéÁöÑ‰ºëÈó≤‰πãÈÄâ',
            icon: 'üç≠'
          };
        } else if (query.includes('Âø´Êõ¥Âà∫ÊøÄ')) {
          customGame = {
            name: 'ÂíåÂπ≥Á≤æËã±',
            reason: 'Âø´ËäÇÂ•èÊàòÊúØÁ´ûÊäÄÔºåËÇæ‰∏äËÖ∫Á¥†È£ôÂçáÁöÑÂà∫ÊøÄ‰ΩìÈ™åÔºåÊØèÂ±ÄÈÉΩÊòØÊñ∞ÊåëÊàò',
            icon: 'üéØ'
          };
        } else if (query.includes('Á§æ‰∫§Ê∏∏Êàè')) {
          customGame = {
            name: 'Ëõã‰ªîÊ¥æÂØπ',
            reason: 'Ë∂ÖËêåÂ§ö‰∫∫ÈóØÂÖ≥ÔºåÂíåÊúãÂèã‰∏ÄËµ∑ÊêûÊÄ™‰∫íÂùëÔºåÁ§æ‰∫§Â®±‰πê‰∏§‰∏çËØØ',
            icon: 'ü•ö'
          };
        } else if (query.includes('Á≠ñÁï•Ëß£Ë∞ú')) {
          customGame = {
            name: 'Á∫™ÂøµÁ¢ëË∞∑',
            reason: 'ËßÜÈîôËßâËß£Ë∞úÁ•û‰ΩúÔºåÁ≤æÁæéËâ∫ÊúØÈ£éÊ†ºÈÖçÂêàÁÉßËÑëË∞úÈ¢òÔºåÁ≠ñÁï•ÊÄßÂçÅË∂≥',
            icon: 'üèõÔ∏è'
          };
        } else if (query.includes('ÂÖçË¥π') || query.includes('‰Ωé‰ªòË¥π')) {
          customGame = {
            name: 'ÁéãËÄÖËç£ËÄÄ',
            reason: 'ÂÆåÂÖ®ÂÖçË¥πÁöÑMOBAÊ∏∏ÊàèÔºåËã±ÈõÑËΩÆÊç¢ÂÖçË¥π‰ΩøÁî®ÔºåÊäÄÊúØËÉúËøáÊ∞™Èáë',
            icon: 'üëë'
          };
        } else if (query.includes('ÁîªÈù¢') || query.includes('Èü≥‰πê')) {
          customGame = {
            name: 'ÂéüÁ•û',
            reason: '‰∏ªÊú∫Á∫ßÁîªÈù¢ÂìÅË¥®ÔºåÁÆ°Âº¶‰πêÂõ¢ÈÖç‰πêÔºåËßÜÂê¨ÁõõÂÆ¥Á∫ßÁöÑÊ∏∏Êàè‰ΩìÈ™å',
            icon: 'üåü'
          };
        }

        addMessage(renderRecommendation(customGame));
        
        setTimeout(() => {
          addMessage(`
            <div class="taste-card">
              <h3>üéØ ËøôÊ¨°ÁöÑÊé®ËçêÂ¶Ç‰ΩïÔºü</h3>
              <div class="desc">
                ÊàëÊ†πÊçÆ‰Ω†ÁöÑÂèçÈ¶àËøõË°å‰∫ÜË∞ÉÊï¥ÔºåÂ∏åÊúõËøôÊ¨°Êõ¥Á¨¶Âêà‰Ω†ÁöÑÊúüÂæÖÔºÅ<br>
                <span style="color:var(--muted);font-size:13px">Â¶ÇÊûúËøò‰∏çÊª°ÊÑèÔºåÂèØ‰ª•ÁªßÁª≠ÂëäËØâÊàëÂÖ∑‰ΩìÊÉ≥Ê≥ï</span>
              </div>
              <div class="game-actions" style="margin-top:12px">
                <button class="btn-primary" onclick="handlePositiveFeedback()">ËøôÊ¨°ÂæàÊ£íÔºÅ</button>
                <button class="btn-ghost" onclick="showSmartQueries()">ËøòÊÉ≥Ë∞ÉÊï¥</button>
              </div>
            </div>
          `);
        }, 800);
        
      }, 1500);
    }

    // Â∑•ÂÖ∑ÂáΩÊï∞
    function openGame(gameName) {
      showToast(`Ê≠£Âú®‰∏∫‰Ω†Ë∑≥ËΩ¨Âà∞ ${gameName} üöÄ`);
    }

    function saveGame(gameName) {
      showToast(`${gameName} Â∑≤Âä†ÂÖ•‰Ω†ÁöÑÂøÉÊÑøÂçï üíñ`, 'success');
    }

    function getMoreGuides(title) {
      showToast(`Ê≠£Âú®ÊêúÁ¥¢Êõ¥Â§öÂÖ≥‰∫é ${title} ÁöÑÊîªÁï• üìö`);
    }

    function saveGuide(title) {
      showToast(`${title} Â∑≤Êî∂ËóèÂà∞‰Ω†ÁöÑÊîªÁï•Êú¨ üìñ`, 'success');
    }

    function getGuide(guideName) {
      guideInput.value = guideName;
      getGameGuide();
    }

    function getPaymentAdvice(adviceName) {
      paymentInput.value = adviceName;
      getPaymentAdvice();
    }

    // ‰∫ã‰ª∂ÁõëÂê¨Âô®ËÆæÁΩÆ
    function setupEventListeners() {
      // TabÂàáÊç¢
      document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
          const tabName = tab.dataset.tab;
          switchTab(tabName);
        });
      });

      // ËæìÂÖ•Ê°ÜÂõûËΩ¶‰∫ã‰ª∂
      gameInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') analyzeGame();
      });
      
      guideInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') getGameGuide();
      });
      
      paymentInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') getPaymentAdvice();
      });
      
      chatInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendChatMessage();
      });

      // ÊåâÈíÆ‰∫ã‰ª∂
      analyzeBtn.addEventListener('click', analyzeGame);
      guideBtn.addEventListener('click', getGameGuide);
      paymentBtn.addEventListener('click', getPaymentAdvice);
      chatBtn.addEventListener('click', sendChatMessage);

      // Âø´Êç∑Ê†áÁ≠æ‰∫ã‰ª∂
      document.querySelectorAll('.tag').forEach(tag => {
        tag.addEventListener('click', () => {
          const gameName = tag.dataset.game;
          if (gameName) {
            gameInput.value = gameName;
            analyzeGame();
          } else {
            // Â§ÑÁêÜÂÖ∂‰ªñÁ±ªÂûãÁöÑÊ†áÁ≠æÁÇπÂáª
            const clickHandler = tag.getAttribute('onclick');
            if (clickHandler) {
              eval(clickHandler);
            }
          }
        });
      });

      // ËæìÂÖ•Ê°ÜÁÑ¶ÁÇπ‰∫ã‰ª∂ - ÊòæÁ§∫Êô∫ËÉΩÂª∫ËÆÆ
      const inputs = [gameInput, guideInput, paymentInput, chatInput];
      inputs.forEach(input => {
        input.addEventListener('focus', () => {
          if (!input.value.trim()) {
            smartSuggestions.classList.add('show');
          }
        });
        
        input.addEventListener('input', () => {
          if (input.value.trim()) {
            smartSuggestions.classList.remove('show');
          }
        });
      });

      // ÁÇπÂáªÂÖ∂‰ªñÂå∫ÂüüÈöêËóèÂª∫ËÆÆ
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.smart-suggestions') && !e.target.closest('.input-bar')) {
          smartSuggestions.classList.remove('show');
        }
      });
    }

    // Êö¥Èú≤ÂÖ®Â±ÄÂáΩÊï∞
    window.handlePositiveFeedback = handlePositiveFeedback;
    window.showSmartQueries = showSmartQueries;
    window.refineWithQuery = refineWithQuery;
    window.useSmartSuggestion = useSmartSuggestion;
    window.openGame = openGame;
    window.saveGame = saveGame;
    window.getMoreGuides = getMoreGuides;
    window.saveGuide = saveGuide;
    window.getGuide = getGuide;
    window.getPaymentAdvice = getPaymentAdvice;

    // ÂàùÂßãÂåñ
    document.addEventListener('DOMContentLoaded', () => {
      setupEventListeners();
      updateSmartSuggestions('recommend');
      
      // Á≥ªÁªüËá™Ê£Ä
      setTimeout(() => {
        const tests = [
          { name: 'Ê∏∏ÊàèÊ°£Ê°àÊï∞ÊçÆÂä†ËΩΩ', pass: Object.keys(gameProfiles).length > 0 },
          { name: 'Êé®ËçêÁ≥ªÁªüÂàùÂßãÂåñ', pass: Object.keys(gameRecommendations).length > 0 },
          { name: 'ÊîªÁï•Á≥ªÁªüÂä†ËΩΩ', pass: Object.keys(gameGuides).length > 0 },
          { name: '‰ªòË¥πÂª∫ËÆÆÁ≥ªÁªü', pass: Object.keys(paymentAdvices).length > 0 },
          { name: 'DOMÂÖÉÁ¥†ÊåÇËΩΩ', pass: !!document.getElementById('conversation') },
          { name: 'TabÂàáÊç¢ÂäüËÉΩ', pass: typeof switchTab === 'function' },
          { name: 'ÂÖ®Â±ÄÂáΩÊï∞Êö¥Èú≤', pass: typeof window.handlePositiveFeedback === 'function' }
        ];
        
        const allPassed = tests.every(t => t.pass);
        const toast = document.createElement('div');
        toast.className = 'toast';
        toast.style.background = allPassed ? 'rgba(16,185,129,0.2)' : 'rgba(239,68,68,0.2)';
        toast.style.borderColor = allPassed ? 'rgba(16,185,129,0.4)' : 'rgba(239,68,68,0.4)';
        toast.innerHTML = `${allPassed ? '‚úÖ' : '‚ùå'} Ê∏∏ÊàèAIÂä©ÊâãÂ∑≤Â∞±Áª™ ¬∑ ${allPassed ? 'ÊâÄÊúâÂäüËÉΩÊ≠£Â∏∏' : 'ÈÉ®ÂàÜÂäüËÉΩÂºÇÂ∏∏'}`;
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
      }, 500);
    });
  </script>
</body>
</html>