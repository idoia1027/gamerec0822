<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æ¸¸æˆæ™ºèƒ½åŠ©æ‰‹ Â· ä½ çš„ä¸“å±æ¸¸æˆAIé¡¾é—®</title>
  <style>
    :root{
      --bg:#0a0d16; --bg1:#0e1220; --bg2:#151B2E;
      --brand1:#00d4ff; --brand2:#8b5cf6; --brand3:#10b981;
      --accent:#ff6b6b; --gold:#fbbf24;
      --muted:#94a3b8; --glass: rgba(255,255,255,.08);
      --outline: rgba(255,255,255,.12); --ring: rgba(0,212,255,.3);
      --shadow: 0 25px 70px rgba(0,0,0,.4);
      --glow: 0 0 30px rgba(0,212,255,.2);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: 'SF Pro Display', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, 'PingFang SC', sans-serif;
      background:
        radial-gradient(1400px 700px at 80% -15%, rgba(0,212,255,.15), transparent 65%),
        radial-gradient(1200px 900px at -15% 110%, rgba(139,92,246,.18), transparent 65%),
        radial-gradient(800px 600px at 50% 50%, rgba(16,185,129,.08), transparent 70%),
        linear-gradient(150deg, var(--bg1), var(--bg2));
      color:#f1f5f9; min-height:100vh; overflow-x:hidden;
    }
    .app{max-width:440px;margin:0 auto;min-height:100vh;display:flex;flex-direction:column;position:relative}

    .header{position:sticky;top:0;z-index:20;backdrop-filter: blur(15px);
      background: linear-gradient(180deg, rgba(10,13,22,.9), rgba(10,13,22,.4) 70%, transparent);
      padding:15px 18px 0;border-bottom:1px solid var(--outline)}
    .logo-section{display:flex;gap:14px;align-items:center;margin-bottom:12px}
    .logo{width:38px;height:38px;border-radius:12px;
      background:conic-gradient(from 200deg, var(--brand1), var(--brand2), var(--accent));
      box-shadow:var(--glow), inset 0 0 20px rgba(255,255,255,.1);
      position:relative;overflow:hidden}
    .logo::after{content:'ğŸ®';position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:18px}
    .title{font-weight:900;letter-spacing:-.02em;font-size:18px}
    .subtitle{font-size:13px;color:var(--muted);margin-top:1px}

    /* æ–°å¢ï¼šé¡¶éƒ¨Tabå¯¼èˆª */
    .nav-tabs{display:flex;background:rgba(255,255,255,.04);border-radius:16px;padding:4px;margin-bottom:15px}
    .tab{flex:1;padding:10px 8px;border-radius:12px;text-align:center;font-size:13px;font-weight:600;
      cursor:pointer;transition:all .3s;position:relative;display:flex;align-items:center;justify-content:center;gap:6px}
    .tab.active{background:linear-gradient(135deg, var(--brand1), var(--brand2));
      color:#0a0d16;box-shadow:0 8px 25px rgba(0,212,255,.25)}
    .tab:not(.active){color:var(--muted)}
    .tab:not(.active):hover{background:rgba(255,255,255,.06);color:#e2e8f0}

    .input-section{padding:0 18px 8px}
    .input-bar{display:flex;gap:12px;align-items:center;background:var(--glass);
      border:1px solid var(--outline);border-radius:20px;padding:12px 16px;
      box-shadow: var(--shadow);transition:all .3s ease;position:relative;overflow:hidden}
    .input-bar::before{content:'';position:absolute;inset:0;background:linear-gradient(45deg, transparent, rgba(0,212,255,.02), transparent);opacity:0;transition:opacity .3s}
    .input-bar:hover::before{opacity:1}
    .input-bar:hover{border-color:rgba(0,212,255,.3);box-shadow:var(--shadow),var(--glow)}
    .input-bar input{flex:1;background:transparent;border:none;outline:none;color:#fff;font-size:16px;font-weight:500}
    .input-bar input::placeholder{color:var(--muted)}
    .action-btn{border:none;cursor:pointer;color:#0a0d16;font-weight:800;border-radius:16px;
      background:linear-gradient(135deg,var(--brand1),var(--brand2)); padding:12px 20px; 
      box-shadow:0 15px 40px var(--ring);transition:all .2s ease;position:relative}
    .action-btn:hover{transform:translateY(-1px);box-shadow:0 20px 50px var(--ring)}
    .action-btn.guide{background:linear-gradient(135deg,var(--accent),var(--gold))}

    /* æ™ºèƒ½å»ºè®®æ¡ */
    .smart-suggestions{padding:8px 18px;display:none}
    .smart-suggestions.show{display:block}
    .suggestion-item{display:flex;align-items:center;gap:10px;padding:12px 16px;margin-bottom:8px;
      background:linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--outline);border-radius:16px;cursor:pointer;transition:all .3s}
    .suggestion-item:hover{background:linear-gradient(135deg, rgba(0,212,255,.1), rgba(139,92,246,.05));
      border-color:rgba(0,212,255,.3);transform:translateY(-1px)}
    .suggestion-icon{font-size:16px}
    .suggestion-text{flex:1;font-size:14px;font-weight:500}
    .suggestion-hint{font-size:12px;color:var(--muted)}

    .quick-tags{display:flex;flex-wrap:wrap;gap:10px;padding:12px 18px}
    .tag{padding:10px 16px;border-radius:20px;background:linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid var(--outline);font-size:13px;color:#e2e8f0;cursor:pointer;transition:all .3s;
      position:relative;overflow:hidden;font-weight:600}
    .tag::before{content:'';position:absolute;inset:0;background:linear-gradient(45deg, var(--brand1), var(--brand2));opacity:0;transition:opacity .3s}
    .tag:hover{transform:translateY(-2px); box-shadow:0 10px 25px rgba(0,0,0,.3)}
    .tag:hover::before{opacity:.1}

    .timeline{display:flex;flex-direction:column;gap:16px;padding:12px 16px 120px}
    .message{border:1px solid var(--outline);background:rgba(14,18,32,.7);backdrop-filter: blur(15px);
      border-radius:24px;padding:18px;box-shadow: var(--shadow);position:relative}
    .message.ai{align-self:flex-start;max-width:95%}
    .message.user{align-self:flex-end;max-width:85%;background:linear-gradient(135deg, rgba(0,212,255,.08), rgba(139,92,246,.08));}
    .message::before{content:'';position:absolute;inset:0;border-radius:24px;background:linear-gradient(45deg, transparent, rgba(255,255,255,.02), transparent);pointer-events:none}

    .taste-card{border:1px solid var(--outline);background:rgba(15,19,35,.8);backdrop-filter: blur(15px); 
      border-radius:24px;padding:20px;box-shadow: var(--shadow);position:relative;overflow:hidden}
    .taste-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
      background:linear-gradient(90deg, var(--brand1), var(--brand2), var(--accent));opacity:.8}
    .taste-card h3{margin:0 0 12px 0;font-size:17px;font-weight:800;display:flex;align-items:center;gap:8px}
    .taste-card .desc{color:var(--muted);line-height:1.5;font-size:14px}

    .radar-section{margin-top:16px}
    .radar-wrap{position:relative;background:rgba(10,13,22,.6);border-radius:20px;padding:20px;
      border:1px solid rgba(255,255,255,.08)}
    .radar-canvas{width:100%;height:280px;border-radius:16px}
    .taste-legend{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:16px}
    .legend-item{display:flex;align-items:center;gap:8px;padding:8px 12px;
      background:rgba(255,255,255,.04);border-radius:12px;font-size:12px}
    .legend-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
    .legend-level{color:var(--muted);margin-left:auto;font-weight:600}

    .game-rec{border:1px solid var(--outline);background:rgba(15,19,35,.8);backdrop-filter: blur(15px); 
      border-radius:24px;padding:20px;box-shadow: var(--shadow);position:relative}
    .game-rec::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
      background:linear-gradient(90deg, var(--accent), var(--gold));opacity:.9}
    .game-rec h3{margin:0 0 16px 0;font-size:17px;font-weight:800;color:var(--accent)}

    /* æ”»ç•¥å¡ç‰‡æ ·å¼ */
    .guide-card{border:1px solid var(--outline);background:rgba(15,19,35,.8);backdrop-filter: blur(15px); 
      border-radius:24px;padding:20px;box-shadow: var(--shadow);position:relative}
    .guide-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
      background:linear-gradient(90deg, var(--brand3), var(--brand1));opacity:.9}
    .guide-card h3{margin:0 0 16px 0;font-size:17px;font-weight:800;color:var(--brand3)}

    .game-showcase{display:flex;gap:16px;align-items:flex-start}
    .game-cover{width:72px;height:72px;border-radius:16px;position:relative;overflow:hidden;
      background:linear-gradient(135deg, var(--brand2), var(--accent));display:flex;align-items:center;justify-content:center;
      box-shadow:0 15px 35px rgba(139,92,246,.3)}
    .game-cover::after{content:'ğŸ¯';font-size:28px;filter:drop-shadow(0 2px 4px rgba(0,0,0,.3))}
    .game-info{flex:1;min-width:0}
    .game-title{font-weight:900;font-size:16px;margin-bottom:8px;color:#fff}
    .game-reason{color:var(--muted);line-height:1.5;font-size:14px;margin-bottom:14px}
    .game-actions{display:flex;gap:10px;flex-wrap:wrap}
    .btn-primary{background:linear-gradient(135deg,var(--accent),var(--gold));border:none;padding:10px 18px;
      border-radius:16px;font-weight:800;color:#0a0d16;cursor:pointer;font-size:14px;
      box-shadow:0 12px 30px rgba(255,107,107,.25);transition:all .2s}
    .btn-primary:hover{transform:translateY(-1px);box-shadow:0 16px 40px rgba(255,107,107,.35)}
    .btn-ghost{border:1px solid var(--outline);background:rgba(255,255,255,.06);padding:10px 16px;
      border-radius:16px;font-weight:700;color:#e5e7eb;cursor:pointer;font-size:14px;transition:all .2s}
    .btn-ghost:hover{background:rgba(255,255,255,.1);transform:translateY(-1px)}

    /* å¿«é€Ÿåé¦ˆä¼˜åŒ– */
    .quick-feedback{border:1px solid var(--outline);background:rgba(15,19,35,.8);backdrop-filter: blur(15px); 
      border-radius:24px;padding:20px;box-shadow: var(--shadow);position:relative}
    .feedback-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
    .feedback-option{padding:12px 16px;border-radius:16px;background:linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--outline);text-align:center;cursor:pointer;transition:all .3s;font-size:13px;font-weight:600}
    .feedback-option:hover{background:linear-gradient(135deg, rgba(0,212,255,.1), rgba(139,92,246,.05));
      border-color:rgba(0,212,255,.3);transform:translateY(-2px)}
    .feedback-option.negative{border-color:rgba(255,107,107,.3)}
    .feedback-option.negative:hover{background:linear-gradient(135deg, rgba(255,107,107,.1), rgba(255,107,107,.05));
      border-color:rgba(255,107,107,.4)}

    /* æ™ºèƒ½å¼•å¯¼æŸ¥è¯¢ */
    .smart-queries{margin-top:16px}
    .query-item{display:flex;align-items:center;gap:12px;padding:12px 16px;margin-bottom:8px;
      background:rgba(255,255,255,.04);border:1px solid var(--outline);border-radius:16px;
      cursor:pointer;transition:all .3s;font-size:14px}
    .query-item:hover{background:rgba(0,212,255,.08);border-color:rgba(0,212,255,.3);transform:translateX(4px)}
    .query-icon{font-size:16px;opacity:.8}
    .query-text{flex:1;font-weight:500}
    .query-arrow{color:var(--muted);font-size:12px}

    .thinking{display:inline-flex;gap:6px;align-items:center;color:var(--brand1)}
    .thinking-dot{width:6px;height:6px;border-radius:50%;background:currentColor;
      animation: pulse 1.4s infinite ease-in-out}
    .thinking-dot:nth-child(2){animation-delay:.2s}
    .thinking-dot:nth-child(3){animation-delay:.4s}
    @keyframes pulse{0%,80%,100%{transform:scale(.6);opacity:.3}40%{transform:scale(1);opacity:1}}

    .slide-in{animation:slideIn .4s ease-out forwards;opacity:0;transform:translateY(10px)}
    @keyframes slideIn{to{opacity:1;transform:translateY(0)}}

    .toast{position:fixed;top:20px;left:50%;transform:translateX(-50%);
      background:rgba(0,0,0,.8);border:1px solid var(--outline);backdrop-filter:blur(10px);
      padding:10px 16px;border-radius:12px;font-size:13px;z-index:999;font-weight:500}

    /* é›·è¾¾å›¾æ ·å¼ */
    .radar-bg{fill:rgba(255,255,255,.02);stroke:rgba(255,255,255,.08);stroke-width:1}
    .radar-grid{stroke:rgba(255,255,255,.06);stroke-width:1;fill:none}
    .radar-area{fill:url(#radarGrad);stroke:rgba(0,212,255,.6);stroke-width:2;opacity:.8}
    .radar-point{fill:var(--brand1);stroke:#fff;stroke-width:2;filter:drop-shadow(0 2px 6px rgba(0,212,255,.4))}
    .radar-label{fill:#cbd5e1;font-size:11px;font-weight:600;text-anchor:middle}

    /* Tabå†…å®¹åŒºåŸŸ */
    .tab-content{display:none}
    .tab-content.active{display:block}
  </style>
</head>
<body>
  <div class="app">
    <div class="header">
      <div class="logo-section">
        <div class="logo"></div>
        <div>
          <div class="title">æ¸¸æˆæ™ºèƒ½åŠ©æ‰‹</div>
          <div class="subtitle">ä¸“å±AIé¡¾é—® Â· æ¨è Â· æ”»ç•¥ Â· ä»˜è´¹æŒ‡å¯¼</div>
        </div>
      </div>
      
      <!-- æ–°å¢ï¼šé¡¶éƒ¨Tabå¯¼èˆª -->
      <div class="nav-tabs">
        <div class="tab active" data-tab="recommend">
          <span>ğŸ¯</span>
          <span>æ¨è</span>
        </div>
        <div class="tab" data-tab="guide">
          <span>ğŸ“–</span>
          <span>æ”»ç•¥</span>
        </div>
        <div class="tab" data-tab="payment">
          <span>ğŸ’</span>
          <span>ä»˜è´¹</span>
        </div>
        <div class="tab" data-tab="chat">
          <span>ğŸ’¬</span>
          <span>æ´»åŠ¨</span>
        </div>
      </div>
    </div>

    <!-- æ¨èTabå†…å®¹ -->
    <div id="recommend-content" class="tab-content active">
      <div class="input-section">
        <div class="input-bar">
          <input id="gameInput" placeholder="å‘Šè¯‰æˆ‘ä½ æœ€è¿‘åœ¨ç©ä»€ä¹ˆæ¸¸æˆ..." />
          <button class="action-btn" id="analyzeBtn">åˆ†ææˆ‘çš„å“å‘³</button>
        </div>
      </div>

      <!-- æ™ºèƒ½å»ºè®®æ¡ -->
      <div class="smart-suggestions" id="smartSuggestions">
        <div class="suggestion-item" onclick="useSmartSuggestion('æˆ‘æƒ³è¦ç±»ä¼¼åŸç¥çš„å¼€æ”¾ä¸–ç•Œæ¸¸æˆ')">
          <span class="suggestion-icon">ğŸŒŸ</span>
          <span class="suggestion-text">æˆ‘æƒ³è¦ç±»ä¼¼åŸç¥çš„å¼€æ”¾ä¸–ç•Œæ¸¸æˆ</span>
          <span class="suggestion-hint">â†’</span>
        </div>
        <div class="suggestion-item" onclick="useSmartSuggestion('æ¨èé€‚åˆå’Œæœ‹å‹ä¸€èµ·ç©çš„ç«æŠ€æ¸¸æˆ')">
          <span class="suggestion-icon">ğŸ‘¥</span>
          <span class="suggestion-text">æ¨èé€‚åˆå’Œæœ‹å‹ä¸€èµ·ç©çš„ç«æŠ€æ¸¸æˆ</span>
          <span class="suggestion-hint">â†’</span>
        </div>
        <div class="suggestion-item" onclick="useSmartSuggestion('æˆ‘æƒ³æ‰¾è½»æ¾ä¼‘é—²çš„æ‰‹æ¸¸')">
          <span class="suggestion-icon">ğŸ˜Œ</span>
          <span class="suggestion-text">æˆ‘æƒ³æ‰¾è½»æ¾ä¼‘é—²çš„æ‰‹æ¸¸</span>
          <span class="suggestion-hint">â†’</span>
        </div>
      </div>

      <div class="quick-tags">
        <div class="tag" data-game="ç¬¬äº”äººæ ¼">ç¬¬äº”äººæ ¼</div>
        <div class="tag" data-game="è›‹ä»”æ´¾å¯¹">è›‹ä»”æ´¾å¯¹</div>
        <div class="tag" data-game="å…‰Â·é‡">å…‰Â·é‡</div>
        <div class="tag" data-game="ç‹è€…è£è€€">ç‹è€…è£è€€</div>
      </div>
    </div>

    <!-- æ”»ç•¥Tabå†…å®¹ -->
    <div id="guide-content" class="tab-content">
      <div class="input-section">
        <div class="input-bar">
          <input id="guideInput" placeholder="æƒ³è¦ä»€ä¹ˆæ¸¸æˆçš„æ”»ç•¥ï¼Ÿå¦‚ï¼šåŸç¥æ–°æ‰‹æ•™ç¨‹" />
          <button class="action-btn guide" id="guideBtn">è·å–æ”»ç•¥</button>
        </div>
      </div>
      <div class="quick-tags">
        <div class="tag" onclick="getGuide('åŸç¥æ–°æ‰‹æ”»ç•¥')">åŸç¥æ–°æ‰‹æ”»ç•¥</div>
        <div class="tag" onclick="getGuide('ç‹è€…è£è€€ä¸Šåˆ†æŠ€å·§')">ç‹è€…ä¸Šåˆ†æŠ€å·§</div>
        <div class="tag" onclick="getGuide('ç¬¬äº”äººæ ¼æ±‚ç”ŸæŒ‡å—')">ç¬¬äº”æ±‚ç”ŸæŒ‡å—</div>
      </div>
    </div>

    <!-- ä»˜è´¹æŒ‡å¯¼Tabå†…å®¹ -->
    <div id="payment-content" class="tab-content">
      <div class="input-section">
        <div class="input-bar">
          <input id="paymentInput" placeholder="å’¨è¯¢ä»˜è´¹å»ºè®®ï¼Œå¦‚ï¼šåŸç¥æŠ½å¡å»ºè®®" />
          <button class="action-btn" id="paymentBtn">å’¨è¯¢ä»˜è´¹</button>
        </div>
      </div>
      <div class="quick-tags">
        <div class="tag" onclick="getPaymentAdvice('åŸç¥æŠ½å¡æ€§ä»·æ¯”åˆ†æ')">åŸç¥æŠ½å¡åˆ†æ</div>
        <div class="tag" onclick="getPaymentAdvice('ç‹è€…è£è€€çš®è‚¤å€¼ä¸å€¼')">ç‹è€…çš®è‚¤æ¨è</div>
        <div class="tag" onclick="getPaymentAdvice('æ‰‹æ¸¸å……å€¼é¿å‘æŒ‡å—')">å……å€¼é¿å‘æŒ‡å—</div>
      </div>
    </div>

    <!-- èŠå¤©Tabå†…å®¹ -->
    <div id="chat-content" class="tab-content">
      <div class="input-section">
        <div class="input-bar">
          <input id="chatInput" placeholder="å‚ä¸æ´»åŠ¨å¸®åŠ©æˆ‘ä»¬åšçš„æ›´å¥½..." />
          <button class="action-btn" id="chatBtn">å‘é€æ¶ˆæ¯</button>
        </div>
      </div>
    </div>

    <div id="conversation" class="timeline">
      <div class="message ai slide-in">
        <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px">
          <span style="font-size:20px">ğŸ¤–</span>
          <strong style="font-size:16px">ä½ çš„æ¸¸æˆæ™ºèƒ½åŠ©æ‰‹</strong>
        </div>
        <div style="color:var(--muted);line-height:1.5">
          å—¨ï¼æˆ‘æ˜¯ä½ çš„ä¸“å±æ¸¸æˆAIé¡¾é—®ã€‚<br>
          æˆ‘å¯ä»¥å¸®ä½ ï¼š<br>
          <span style="color:var(--brand1);font-weight:700">ğŸ¯ åˆ†æå“å‘³æ¨èæ¸¸æˆ</span> Â·
          <span style="color:var(--brand3);font-weight:700">ğŸ“– æä¾›æ¸¸æˆæ”»ç•¥</span> Â·
          <span style="color:var(--accent);font-weight:700">ğŸ’ ä»˜è´¹å†³ç­–æŒ‡å¯¼</span> Â·
          <span style="color:var(--gold);font-weight:700">ğŸ’¬ å‚ä¸æ´»åŠ¨ï¼Œè®©ä½ aiæ›´æ‡‚ä½ </span>
        </div>
      </div>
    </div>
  </div>

  <script>
    // æ¸¸æˆæ•°æ®åº“
    const gameProfiles = {
      'ç¬¬äº”äººæ ¼': {
        analysis: 'ä½ æ˜¯ä¸ª<span style="color:var(--accent);font-weight:700">ç­–ç•¥æ€ç»´è€…</span>ï¼Œå–œæ¬¢åœ¨ç´§å¼ åˆºæ¿€ä¸­åŠ¨è„‘ç­‹ï¼Œäº«å—ä¸å¯¹ç§°ç«æŠ€çš„å¿ƒç†åšå¼ˆã€‚ä½ å¯¹æ¸¸æˆçš„<span style="color:var(--brand1)">å…¬å¹³æ€§</span>å¾ˆåœ¨æ„ï¼Œæ„¿æ„ä¸ºä¼˜è´¨ä½“éªŒä»˜è´¹ï¼Œä½†è®¨åŒè¿‡åº¦æ°ªé‡‘ã€‚',
        dna: {
          'ç­–ç•¥æ€è€ƒ': 95,
          'ç«æŠ€å¯¹æŠ—': 80,
          'æ‚¬ç–‘è§£è°œ': 75,
          'å›¢é˜Ÿåä½œ': 60,
          'ä¼‘é—²å¨±ä¹': 30,
          'æ”¶é›†å…»æˆ': 45
        }
      },
      'è›‹ä»”æ´¾å¯¹': {
        analysis: 'ä½ æ˜¯ä¸ª<span style="color:var(--gold);font-weight:700">å¿«ä¹ä¸»ä¹‰è€…</span>ï¼Œé…·çˆ±è½»æ¾ææ€ªçš„å¤šäººæ¸¸æˆï¼Œå–œæ¬¢å’Œæœ‹å‹ä¸€èµ·å“ˆå“ˆå¤§ç¬‘ã€‚ä½ ä¸å¤ªåœ¨ä¹è¾“èµ¢ï¼Œæ›´äº«å—æ¸¸æˆè¿‡ç¨‹ä¸­çš„<span style="color:var(--brand3)">ç¤¾äº¤ä¹è¶£</span>ã€‚',
        dna: {
          'ä¼‘é—²å¨±ä¹': 95,
          'ç¤¾äº¤äº’åŠ¨': 85,
          'å¯çˆ±æ²»æ„ˆ': 80,
          'å›¢é˜Ÿåä½œ': 70,
          'ç«æŠ€å¯¹æŠ—': 40,
          'ç­–ç•¥æ€è€ƒ': 25
        }
      },
      'å…‰Â·é‡': {
        analysis: 'ä½ æ˜¯ä¸ª<span style="color:var(--brand3);font-weight:700">æƒ…æ„Ÿä½“éªŒè€…</span>ï¼Œè¿½æ±‚æ¸¸æˆä¸­çš„ç¾æ„Ÿå’Œæƒ…æ„Ÿå…±é¸£ï¼Œå–œæ¬¢æ¸©æš–æ²»æ„ˆçš„ç¤¾äº¤ä½“éªŒã€‚ä½ æ›´çœ‹é‡æ¸¸æˆçš„<span style="color:var(--brand2)">è‰ºæœ¯ä»·å€¼</span>ï¼Œä¸å–œæ¬¢æ¿€çƒˆç«äº‰ã€‚',
        dna: {
          'å¯çˆ±æ²»æ„ˆ': 95,
          'ç¤¾äº¤äº’åŠ¨': 80,
          'è‰ºæœ¯ç¾å­¦': 90,
          'æ¢ç´¢å†’é™©': 70,
          'ç«æŠ€å¯¹æŠ—': 20,
          'ç­–ç•¥æ€è€ƒ': 35
        }
      },
      'ç‹è€…è£è€€': {
        analysis: 'ä½ æ˜¯ä¸ª<span style="color:var(--accent);font-weight:700">ç«æŠ€ä¹‹ç‹</span>ï¼Œçƒ­è¡·äºMOBAçš„ç­–ç•¥å¯¹æŠ—ï¼Œäº«å—å›¢é˜Ÿé…åˆå‡»è´¥å¯¹æ‰‹çš„å¿«æ„Ÿã€‚ä½ å¯¹æ¸¸æˆ<span style="color:var(--brand1)">æ“ä½œæ‰‹æ„Ÿ</span>è¦æ±‚å¾ˆé«˜ï¼Œæ„¿æ„æŠ•å…¥æ—¶é—´é’»ç ”ã€‚',
        dna: {
          'ç«æŠ€å¯¹æŠ—': 95,
          'ç­–ç•¥æ€è€ƒ': 85,
          'å›¢é˜Ÿåä½œ': 80,
          'æŠ€å·§æ“ä½œ': 90,
          'ä¼‘é—²å¨±ä¹': 30,
          'å¯çˆ±æ²»æ„ˆ': 15
        }
      }
    };

    const gameRecommendations = {
      'ç­–ç•¥æ€è€ƒ': [
        { name: 'ä¸‰å›½å¿—Â·æˆ˜ç•¥ç‰ˆ', reason: 'ç¡¬æ ¸ç­–ç•¥SLGï¼Œæ»¡è¶³ä½ å¯¹æ·±åº¦ç­–ç•¥çš„æ¸´æœ›ï¼ŒçœŸå®è¿˜åŸä¸‰å›½äº‰éœ¸', icon: 'âš”ï¸' },
        { name: 'æ–‡æ˜6', reason: 'å›åˆåˆ¶ç­–ç•¥ç»å…¸ï¼Œä»çŸ³å™¨æ—¶ä»£å»ºè®¾æ–‡æ˜å¸å›½ï¼Œç­–ç•¥æ·±åº¦çˆ†è¡¨', icon: 'ğŸ›ï¸' }
      ],
      'ç«æŠ€å¯¹æŠ—': [
        { name: 'å’Œå¹³ç²¾è‹±', reason: 'æˆ˜æœ¯ç«æŠ€æ ‡æ†ï¼Œç™¾äººç«æŠ€ç´§å¼ åˆºæ¿€ï¼Œè€ƒéªŒä½ çš„ç»¼åˆå®åŠ›', icon: 'ğŸ¯' },
        { name: 'APEXè‹±é›„æ‰‹æ¸¸', reason: 'è‹±é›„å°„å‡»ç«æŠ€ï¼Œå›¢é˜Ÿé…åˆ+ä¸ªäººæŠ€å·§ï¼Œç«æŠ€ä½“éªŒæ‹‰æ»¡', icon: 'ğŸš€' }
      ],
      'ä¼‘é—²å¨±ä¹': [
        { name: 'å¼€å¿ƒæ¶ˆæ¶ˆä¹', reason: 'ç»å…¸ä¸‰æ¶ˆæ¸¸æˆï¼Œç®€å•æ˜“ä¸Šæ‰‹ï¼Œç¢ç‰‡æ—¶é—´çš„å®Œç¾é€‰æ‹©', icon: 'ğŸ­' },
        { name: 'æ˜Ÿéœ²è°·ç‰©è¯­', reason: 'ç”°å›­ç”Ÿæ´»æ¨¡æ‹Ÿï¼Œç§ç”°é’“é±¼æŒ–çŸ¿ï¼Œæ²»æ„ˆç³»farmingç¥ä½œ', icon: 'ğŸŒ±' }
      ],
      'ç¤¾äº¤äº’åŠ¨': [
        { name: 'Among Us', reason: 'å¤ªç©ºç‹¼äººæ€ï¼Œæœ‹å‹èšä¼šå¿…å¤‡ï¼Œè€ƒéªŒæ¼”æŠ€å’Œæ¨ç†èƒ½åŠ›', icon: 'ğŸ‘¥' },
        { name: 'QQé£è½¦', reason: 'ç«é€Ÿ+ç¤¾äº¤ï¼Œå’Œå¥½å‹ä¸€èµ·é£™è½¦ï¼Œè¿˜èƒ½ç§€ç‚«é…·æ—¶è£…', icon: 'ğŸ' }
      ],
      'å¯çˆ±æ²»æ„ˆ': [
        { name: 'æ‘©å°”åº„å›­', reason: 'ç«¥å¹´å›å¿†å¤æ´»ï¼ç§èœå…»æ‹‰å§†ï¼Œå’Œæœ‹å‹ä¸€èµ·é‡æ¸©çº¯çœŸæ—¶å…‰', icon: 'ğŸ¾' },
        { name: 'åŠ¨ç‰©æ£®å‹ä¼š', reason: 'æ— äººå²›ç”Ÿæ´»æ¨¡æ‹Ÿï¼ŒDIYè£…æ‰®å®¶å›­ï¼Œè¶…æ²»æ„ˆçš„æ…¢èŠ‚å¥ä½“éªŒ', icon: 'ğŸï¸' }
      ],
      'æ¢ç´¢å†’é™©': [
        { name: 'åŸç¥', reason: 'å¼€æ”¾ä¸–ç•ŒRPGï¼Œä¸ƒå›½å†’é™©ç­‰ä½ æ¢ç´¢ï¼Œç”»é¢éŸ³ä¹éƒ½æ˜¯è‰ºæœ¯å“çº§åˆ«', icon: 'ğŸŒŸ' },
        { name: 'å¡å°”è¾¾ä¼ è¯´', reason: 'å¼€æ”¾ä¸–ç•Œæ¢ç´¢æ ‡æ†ï¼Œæ¯ä¸ªè§’è½éƒ½æœ‰æƒŠå–œç­‰ä½ å‘ç°', icon: 'ğŸ—¡ï¸' }
      ]
    };

    // æ”»ç•¥æ•°æ®åº“
    const gameGuides = {
      'åŸç¥æ–°æ‰‹æ”»ç•¥': {
        title: 'åŸç¥æ–°æ‰‹å®Œå…¨æŒ‡å—',
        content: 'ğŸŒŸ <strong>æ–°æ‰‹å¿…çŸ¥è¦ç‚¹ï¼š</strong><br>â€¢ ä¼˜å…ˆæå‡ä¸»Cè§’è‰²ç­‰çº§å’Œæ­¦å™¨<br>â€¢ æ¯æ—¥å§”æ‰˜å’Œä½“åŠ›ä¸è¦æµªè´¹<br>â€¢ å‰æœŸé‡ç‚¹åŸ¹å…»ä¸€ä¸ªè¾“å‡ºè§’è‰²<br>â€¢ æ¢ç´¢åœ°å›¾æ”¶é›†ç¥ç³æå‡ä½“åŠ›<br>â€¢ åˆç†è§„åˆ’åŸçŸ³ï¼Œé¿å…ä¹±æŠ½å¡',
        tips: ['ä½“åŠ›>ç»éªŒ>ææ–™çš„ä¼˜å…ˆçº§', 'æ–°æ‰‹æ± å¿…æŠ½ï¼Œä¿åº•å‡º5æ˜Ÿè§’è‰²', 'ä¸»çº¿ä»»åŠ¡ä¼˜å…ˆå®Œæˆ']
      },
      'ç‹è€…è£è€€ä¸Šåˆ†æŠ€å·§': {
        title: 'ç‹è€…ä¸Šåˆ†æ ¸å¿ƒæŠ€å·§',
        content: 'âš¡ <strong>ä¸Šåˆ†å…³é”®ç­–ç•¥ï¼š</strong><br>â€¢ ä¸“ç²¾2-3ä¸ªä½ç½®ï¼Œä¸è¦ä»€ä¹ˆéƒ½ç©<br>â€¢ å­¦ä¼šçœ‹å°åœ°å›¾ï¼Œæ„è¯†æ¯”æ“ä½œæ›´é‡è¦<br>â€¢ å›¢æˆ˜ç«™ä½ï¼šè¾“å‡ºé åï¼Œå¦å…‹å¼€å›¢<br>â€¢ ç»æµé¢†å…ˆæ—¶æ¨å¡”ï¼ŒåŠ£åŠ¿æ—¶å‘è‚²<br>â€¢ æ²Ÿé€šå¤§äºä¸ªäººç§€ï¼Œé…åˆåˆ¶èƒœ',
        tips: ['é€‰æ‹©å¼ºåŠ¿è‹±é›„è·Ÿç‰ˆæœ¬', 'æ§åˆ¶æƒ…ç»ªï¼Œé¿å…ä¸Šå¤´', 'å¤ç›˜å½•åƒæ‰¾é—®é¢˜']
      },
      'ç¬¬äº”äººæ ¼æ±‚ç”ŸæŒ‡å—': {
        title: 'ç¬¬äº”äººæ ¼æ±‚ç”Ÿç§˜ç±',
        content: 'ğŸ” <strong>æ±‚ç”Ÿæ ¸å¿ƒè¦é¢†ï¼š</strong><br>â€¢ å¼€å±€åˆ†æ•£è§£å¯†ï¼Œé¿å…æŠ±å›¢<br>â€¢ å­¦ä¼šé¢„åˆ¤ç›‘ç®¡è€…è·¯çº¿<br>â€¢ æ¿çª—è¿æ‹›ï¼Œå¡è§†é‡è½¬ç‚¹<br>â€¢ æ•‘äººæ—¶æœºï¼šç›‘ç®¡è€…ç¦»å¼€åå†æ•‘<br>â€¢ æ®‹å±€ç­–ç•¥ï¼šä¼˜å…ˆå¼€é—¨é€ƒè„±',
        tips: ['ç»ƒä¹ èµ°ä½å’Œç¿»çª—æŠ€å·§', 'ç†Ÿæ‚‰åœ°å›¾å¸ƒå±€', 'å›¢é˜Ÿé…åˆèƒœè¿‡ä¸ªäººæŠ€æœ¯']
      }
    };

    // ä»˜è´¹å»ºè®®æ•°æ®åº“
    const paymentAdvices = {
      'åŸç¥æŠ½å¡æ€§ä»·æ¯”åˆ†æ': {
        title: 'åŸç¥æŠ½å¡å†³ç­–æŒ‡å—',
        content: 'ğŸ’ <strong>æŠ½å¡æ€§ä»·æ¯”åˆ†æï¼š</strong><br>â€¢ æœˆå¡æ€§ä»·æ¯”æœ€é«˜ï¼Œå»ºè®®é•¿æœŸè´­ä¹°<br>â€¢ å¤§æœˆå¡é€‚åˆä¸­æ°ªç©å®¶<br>â€¢ UPè§’è‰²æ± ï¼šå¼ºåŠ›ä¸»C>è¾…åŠ©>é‡å¤è§’è‰²<br>â€¢ æ­¦å™¨æ± é£é™©é«˜ï¼Œéå¿…è¦ä¸å»ºè®®æŠ½<br>â€¢ é¢„ç•™åŸçŸ³ï¼šæ¯ç‰ˆæœ¬è‡³å°‘160æŠ½ä¿åº•',
        recommendations: ['æ–°æ‰‹æ¨èï¼šæœˆå¡+BP', 'ä¸­æ°ªæ¨èï¼šå¤§æœˆå¡+é¦–å……åŒå€', 'åªæŠ½å–œæ¬¢çš„è§’è‰²ï¼Œä¸è¿½å¼ºåº¦']
      },
      'ç‹è€…è£è€€çš®è‚¤å€¼ä¸å€¼': {
        title: 'ç‹è€…è£è€€çš®è‚¤è´­ä¹°å»ºè®®',
        content: 'âœ¨ <strong>çš®è‚¤è´­ä¹°ç­–ç•¥ï¼š</strong><br>â€¢ ä¼ è¯´çš®è‚¤ï¼šç‰¹æ•ˆå¥½ä½†ä»·æ ¼é«˜ï¼Œçœ‹ä¸ªäººå–œå¥½<br>â€¢ å²è¯—çš®è‚¤ï¼šæ€§ä»·æ¯”æœ€ä½³ï¼Œå»ºè®®ä¼˜å…ˆè€ƒè™‘<br>â€¢ å‹‡è€…çš®è‚¤ï¼šä¾¿å®œå®ç”¨ï¼Œæ–°æ‰‹å‹å¥½<br>â€¢ é™å®šçš®è‚¤ï¼šé”™è¿‡éš¾å†æœ‰ï¼Œå–œæ¬¢å°±å…¥æ‰‹<br>â€¢ æ´»åŠ¨çš®è‚¤ï¼šé€šè¿‡ä»»åŠ¡è·å¾—ï¼Œæœ€åˆ’ç®—',
        recommendations: ['ä¼˜å…ˆä¹°å¸¸ç”¨è‹±é›„çš„çš®è‚¤', 'ç­‰æŠ˜æ‰£æ´»åŠ¨å†è´­ä¹°', 'çš®è‚¤ä¸å½±å“æ¸¸æˆå¹³è¡¡']
      },
      'æ‰‹æ¸¸å……å€¼é¿å‘æŒ‡å—': {
        title: 'æ‰‹æ¸¸å……å€¼é˜²å‘æ”»ç•¥',
        content: 'âš ï¸ <strong>å……å€¼å‰å¿…çœ‹ï¼š</strong><br>â€¢ è®¾å®šæœˆåº¦é¢„ç®—ï¼Œé¿å…å†²åŠ¨æ¶ˆè´¹<br>â€¢ é¦–å……ç¤¼åŒ…é€šå¸¸æ€§ä»·æ¯”æœ€é«˜<br>â€¢ é¿å¼€æŠ½å¡ç±»"èµŒåš"æœºåˆ¶<br>â€¢ ä¼˜å…ˆè´­ä¹°èƒ½ç›´æ¥æå‡ä½“éªŒçš„å†…å®¹<br>â€¢ å…³æ³¨é€€æ¬¾æ”¿ç­–å’Œå®¢æœå“åº”<br>â€¢ æœªæˆå¹´äººéœ€å®¶é•¿ç›‘ç£',
        recommendations: ['ç†æ€§æ¶ˆè´¹ï¼Œé‡åŠ›è€Œè¡Œ', 'ä¼˜é€‰ä¹°æ–­åˆ¶æ¸¸æˆ', 'è­¦æƒ•è¯±å¯¼å……å€¼å¥—è·¯']
      }
    };

    // å½“å‰æ¿€æ´»çš„tab
    let currentTab = 'recommend';

    // DOMå…ƒç´ 
    const conversation = document.getElementById('conversation');
    const gameInput = document.getElementById('gameInput');
    const analyzeBtn = document.getElementById('analyzeBtn');
    const guideInput = document.getElementById('guideInput');
    const guideBtn = document.getElementById('guideBtn');
    const paymentInput = document.getElementById('paymentInput');
    const paymentBtn = document.getElementById('paymentBtn');
    const chatInput = document.getElementById('chatInput');
    const chatBtn = document.getElementById('chatBtn');
    const smartSuggestions = document.getElementById('smartSuggestions');

    // å·¥å…·å‡½æ•°
    function addMessage(content, type = 'ai') {
      const msg = document.createElement('div');
      msg.className = `message ${type} slide-in`;
      msg.innerHTML = content;
      conversation.appendChild(msg);
      msg.scrollIntoView({ behavior: 'smooth', block: 'end' });
      return msg;
    }

    function showToast(text, type = 'info') {
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = text;
      if (type === 'success') {
        toast.style.background = 'rgba(16,185,129,0.2)';
        toast.style.borderColor = 'rgba(16,185,129,0.4)';
      }
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 2000);
    }

    // Tabåˆ‡æ¢åŠŸèƒ½
    function switchTab(tabName) {
      // æ›´æ–°tabæ¿€æ´»çŠ¶æ€
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
      
      // æ›´æ–°å†…å®¹åŒºåŸŸ
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      document.getElementById(`${tabName}-content`).classList.add('active');
      
      currentTab = tabName;

      // æ ¹æ®tabæ˜¾ç¤ºä¸åŒçš„æ™ºèƒ½å»ºè®®
      updateSmartSuggestions(tabName);
    }

    // æ›´æ–°æ™ºèƒ½å»ºè®®
    function updateSmartSuggestions(tabName) {
      const suggestions = {
        recommend: [
          { icon: 'ğŸŒŸ', text: 'æˆ‘æƒ³è¦ç±»ä¼¼åŸç¥çš„å¼€æ”¾ä¸–ç•Œæ¸¸æˆ', query: 'æˆ‘æƒ³è¦ç±»ä¼¼åŸç¥çš„å¼€æ”¾ä¸–ç•Œæ¸¸æˆ' },
          { icon: 'ğŸ‘¥', text: 'æ¨èé€‚åˆå’Œæœ‹å‹ä¸€èµ·ç©çš„ç«æŠ€æ¸¸æˆ', query: 'æ¨èé€‚åˆå’Œæœ‹å‹ä¸€èµ·ç©çš„ç«æŠ€æ¸¸æˆ' },
          { icon: 'ğŸ˜Œ', text: 'æˆ‘æƒ³æ‰¾è½»æ¾ä¼‘é—²çš„æ‰‹æ¸¸', query: 'æˆ‘æƒ³æ‰¾è½»æ¾ä¼‘é—²çš„æ‰‹æ¸¸' }
        ],
        guide: [
          { icon: 'ğŸ“š', text: 'åŸç¥æ–°æ‰‹æ€ä¹ˆå¿«é€Ÿå‡çº§ï¼Ÿ', query: 'åŸç¥æ–°æ‰‹æ€ä¹ˆå¿«é€Ÿå‡çº§ï¼Ÿ' },
          { icon: 'ğŸ¯', text: 'ç‹è€…è£è€€æ€ä¹ˆå¿«é€Ÿä¸Šåˆ†ï¼Ÿ', query: 'ç‹è€…è£è€€æ€ä¹ˆå¿«é€Ÿä¸Šåˆ†ï¼Ÿ' },
          { icon: 'ğŸ”', text: 'ç¬¬äº”äººæ ¼æ±‚ç”ŸæŠ€å·§åˆ†äº«', query: 'ç¬¬äº”äººæ ¼æ±‚ç”ŸæŠ€å·§åˆ†äº«' }
        ],
        payment: [
          { icon: 'ğŸ’°', text: 'åŸç¥æœˆå¡å’Œå¤§æœˆå¡å“ªä¸ªåˆ’ç®—ï¼Ÿ', query: 'åŸç¥æœˆå¡å’Œå¤§æœˆå¡å“ªä¸ªåˆ’ç®—ï¼Ÿ' },
          { icon: 'âœ¨', text: 'ç‹è€…è£è€€çš®è‚¤å€¼ä¸å€¼å¾—ä¹°ï¼Ÿ', query: 'ç‹è€…è£è€€çš®è‚¤å€¼ä¸å€¼å¾—ä¹°ï¼Ÿ' },
          { icon: 'âš ï¸', text: 'æ‰‹æ¸¸å……å€¼æœ‰ä»€ä¹ˆæ³¨æ„äº‹é¡¹ï¼Ÿ', query: 'æ‰‹æ¸¸å……å€¼æœ‰ä»€ä¹ˆæ³¨æ„äº‹é¡¹ï¼Ÿ' }
        ],
        chat: [
          { icon: 'ğŸ’¬', text: 'æœ€è¿‘æœ‰ä»€ä¹ˆå¥½ç©çš„æ–°æ¸¸æˆå—ï¼Ÿ', query: 'æœ€è¿‘æœ‰ä»€ä¹ˆå¥½ç©çš„æ–°æ¸¸æˆå—ï¼Ÿ' },
          { icon: 'ğŸ®', text: 'ä½ è§‰å¾—æ‰‹æ¸¸å’Œç«¯æ¸¸å“ªä¸ªæ›´å¥½ï¼Ÿ', query: 'ä½ è§‰å¾—æ‰‹æ¸¸å’Œç«¯æ¸¸å“ªä¸ªæ›´å¥½ï¼Ÿ' },
          { icon: 'ğŸ¤”', text: 'æ¸¸æˆå……é’±çœŸçš„èƒ½å˜å¼ºå—ï¼Ÿ', query: 'æ¸¸æˆå……é’±çœŸçš„èƒ½å˜å¼ºå—ï¼Ÿ' }
        ]
      };

      const tabSuggestions = suggestions[tabName] || suggestions.recommend;
      smartSuggestions.innerHTML = tabSuggestions.map(item => `
        <div class="suggestion-item" onclick="useSmartSuggestion('${item.query}')">
          <span class="suggestion-icon">${item.icon}</span>
          <span class="suggestion-text">${item.text}</span>
          <span class="suggestion-hint">â†’</span>
        </div>
      `).join('');
    }

    // ä½¿ç”¨æ™ºèƒ½å»ºè®®
    function useSmartSuggestion(query) {
      const currentInput = getCurrentInput();
      if (currentInput) {
        currentInput.value = query;
        triggerCurrentAction();
      }
      smartSuggestions.classList.remove('show');
    }

    // è·å–å½“å‰æ¿€æ´»çš„è¾“å…¥æ¡†
    function getCurrentInput() {
      switch(currentTab) {
        case 'recommend': return gameInput;
        case 'guide': return guideInput;
        case 'payment': return paymentInput;
        case 'chat': return chatInput;
        default: return gameInput;
      }
    }

    // è§¦å‘å½“å‰tabçš„æ“ä½œ
    function triggerCurrentAction() {
      switch(currentTab) {
        case 'recommend': analyzeGame(); break;
        case 'guide': getGameGuide(); break;
        case 'payment': getPaymentAdvice(); break;
        case 'chat': sendChatMessage(); break;
      }
    }

    // æ¸²æŸ“ç”¨æˆ·ç”»åƒå¡ç‰‡
    function renderTasteProfile(game, profile) {
      return `
        <div class="taste-card">
          <h3>ğŸ§¬ ä½ çš„æ¸¸æˆDNAè§£è¯»</h3>
          <div class="desc">${profile.analysis}</div>
          ${renderRadarChart(profile.dna)}
        </div>
      `;
    }

    // æ¸²æŸ“é›·è¾¾å›¾
    function renderRadarChart(dna) {
      const chartId = `radar_${Date.now()}`;
      return `
        <div class="radar-section">
          <div class="radar-wrap">
            <svg id="${chartId}" class="radar-canvas" viewBox="0 0 300 280">
              <defs>
                <radialGradient id="radarGrad" cx="50%" cy="50%" r="50%">
                  <stop offset="0%" style="stop-color:rgba(0,212,255,0.3)"/>
                  <stop offset="100%" style="stop-color:rgba(139,92,246,0.1)"/>
                </radialGradient>
              </defs>
            </svg>
            <div class="taste-legend">
              ${Object.entries(dna).map(([key, value], index) => `
                <div class="legend-item">
                  <div class="legend-dot" style="background: hsl(${index * 60}, 70%, 60%)"></div>
                  <span>${key}</span>
                  <span class="legend-level">${value}%</span>
                </div>
              `).join('')}
            </div>
          </div>
        </div>
      `;
    }

    // ç»˜åˆ¶é›·è¾¾å›¾
    function drawRadarChart(chartId, dna) {
      const svg = document.getElementById(chartId);
      if (!svg) return;

      const center = { x: 150, y: 140 };
      const maxRadius = 100;
      const categories = Object.keys(dna);
      const values = Object.values(dna);
      const angleStep = (2 * Math.PI) / categories.length;

      svg.innerHTML = svg.innerHTML;

      for (let i = 1; i <= 5; i++) {
        const radius = (maxRadius / 5) * i;
        const points = categories.map((_, index) => {
          const angle = angleStep * index - Math.PI / 2;
          const x = center.x + Math.cos(angle) * radius;
          const y = center.y + Math.sin(angle) * radius;
          return `${x},${y}`;
        }).join(' ');
        
        const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
        polygon.setAttribute('points', points);
        polygon.setAttribute('class', 'radar-bg');
        polygon.style.fill = i === 5 ? 'rgba(255,255,255,0.02)' : 'none';
        polygon.style.stroke = 'rgba(255,255,255,0.06)';
        svg.appendChild(polygon);
      }

      categories.forEach((_, index) => {
        const angle = angleStep * index - Math.PI / 2;
        const x = center.x + Math.cos(angle) * maxRadius;
        const y = center.y + Math.sin(angle) * maxRadius;
        
        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        line.setAttribute('x1', center.x);
        line.setAttribute('y1', center.y);
        line.setAttribute('x2', x);
        line.setAttribute('y2', y);
        line.setAttribute('class', 'radar-grid');
        svg.appendChild(line);
      });

      const dataPoints = values.map((value, index) => {
        const angle = angleStep * index - Math.PI / 2;
        const radius = (value / 100) * maxRadius;
        const x = center.x + Math.cos(angle) * radius;
        const y = center.y + Math.sin(angle) * radius;
        return `${x},${y}`;
      }).join(' ');

      const dataPolygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
      dataPolygon.setAttribute('points', dataPoints);
      dataPolygon.setAttribute('class', 'radar-area');
      svg.appendChild(dataPolygon);

      values.forEach((value, index) => {
        const angle = angleStep * index - Math.PI / 2;
        const radius = (value / 100) * maxRadius;
        const x = center.x + Math.cos(angle) * radius;
        const y = center.y + Math.sin(angle) * radius;
        
        const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
        circle.setAttribute('cx', x);
        circle.setAttribute('cy', y);
        circle.setAttribute('r', 4);
        circle.setAttribute('class', 'radar-point');
        svg.appendChild(circle);
      });

      categories.forEach((category, index) => {
        const angle = angleStep * index - Math.PI / 2;
        const labelRadius = maxRadius + 20;
        const x = center.x + Math.cos(angle) * labelRadius;
        const y = center.y + Math.sin(angle) * labelRadius;
        
        const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        text.setAttribute('x', x);
        text.setAttribute('y', y + 4);
        text.setAttribute('class', 'radar-label');
        text.textContent = category;
        svg.appendChild(text);
      });
    }

    // ç”Ÿæˆæ¸¸æˆæ¨è
    function generateRecommendation(dna) {
      const sortedTraits = Object.entries(dna)
        .sort(([,a], [,b]) => b - a)
        .slice(0, 2);
      
      const primaryTrait = sortedTraits[0][0];
      const recs = gameRecommendations[primaryTrait] || gameRecommendations['ä¼‘é—²å¨±ä¹'];
      const selectedGame = recs[Math.floor(Math.random() * recs.length)];
      
      return selectedGame;
    }

    // æ¸²æŸ“æ¨èå¡ç‰‡
    function renderRecommendation(game) {
      return `
        <div class="game-rec">
          <h3>ğŸ¯ ä¸ºä½ ç²¾é€‰æ¨è</h3>
          <div class="game-showcase">
            <div class="game-cover">
              <div style="font-size: 24px;">${game.icon}</div>
            </div>
            <div class="game-info">
              <div class="game-title">${game.name}</div>
              <div class="game-reason">${game.reason}</div>
              <div class="game-actions">
                <button class="btn-primary" onclick="openGame('${game.name}')">ç«‹å³ä½“éªŒ</button>
                <button class="btn-ghost" onclick="saveGame('${game.name}')">åŠ å…¥å¿ƒæ„¿å•</button>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // æ¸²æŸ“å¿«é€Ÿåé¦ˆ - ä¼˜åŒ–ç‰ˆ
    function renderQuickFeedback() {
      return `
        <div class="quick-feedback">
          <h3>ğŸ’­ è¿™ä¸ªæ¨èæ€ä¹ˆæ ·ï¼Ÿ</h3>
          <div class="feedback-grid">
            <div class="feedback-option" onclick="handlePositiveFeedback()">
              <div style="font-size:18px;margin-bottom:4px">ğŸ‰</div>
              <div>å¾ˆåˆæˆ‘å£å‘³</div>
            </div>
            <div class="feedback-option negative" onclick="showSmartQueries()">
              <div style="font-size:18px;margin-bottom:4px">ğŸ¤”</div>
              <div>ä¸å¤ªå¯¹è·¯</div>
            </div>
          </div>
        </div>
      `;
    }

    // æ™ºèƒ½æŸ¥è¯¢å¼•å¯¼ - é™ä½æ“ä½œæˆæœ¬
    function renderSmartQueries() {
      const queries = [
        { icon: 'ğŸ®', text: 'æƒ³è¦æ›´ä¼‘é—²è½»æ¾çš„æ¸¸æˆ', query: 'æˆ‘æƒ³è¦æ›´ä¼‘é—²è½»æ¾çš„æ¸¸æˆç±»å‹' },
        { icon: 'âš¡', text: 'å¸Œæœ›èŠ‚å¥æ›´å¿«æ›´åˆºæ¿€', query: 'æ¨èèŠ‚å¥æ›´å¿«æ›´åˆºæ¿€çš„æ¸¸æˆ' },
        { icon: 'ğŸ‘¥', text: 'æƒ³è¦å¤šäººç¤¾äº¤ç±»æ¸¸æˆ', query: 'æˆ‘æƒ³è¦é€‚åˆå’Œæœ‹å‹ä¸€èµ·ç©çš„ç¤¾äº¤æ¸¸æˆ' },
        { icon: 'ğŸ§©', text: 'åçˆ±ç­–ç•¥è§£è°œç±»æ¸¸æˆ', query: 'æ¨èç­–ç•¥æ€§å¼ºæˆ–è§£è°œç±»çš„æ¸¸æˆ' },
        { icon: 'ğŸ’°', text: 'å¸Œæœ›æ˜¯å…è´¹æˆ–ä½ä»˜è´¹æ¸¸æˆ', query: 'æ¨èå…è´¹æˆ–ä»˜è´¹è¾ƒå°‘çš„æ¸¸æˆ' },
        { icon: 'ğŸ¨', text: 'æ›´åœ¨æ„æ¸¸æˆç”»é¢å’ŒéŸ³ä¹', query: 'æ¨èç”»é¢ç²¾ç¾éŸ³ä¹å¥½å¬çš„æ¸¸æˆ' }
      ];

      return `
        <div class="taste-card">
          <h3>ğŸ¯ å‘Šè¯‰æˆ‘ä½ æ›´å…·ä½“çš„æƒ³æ³•</h3>
          <div class="desc" style="margin-bottom:16px">ç‚¹å‡»ä¸‹é¢æœ€ç¬¦åˆä½ æƒ³æ³•çš„é€‰é¡¹ï¼Œæˆ‘æ¥é‡æ–°ä¸ºä½ æ¨èï¼š</div>
          <div class="smart-queries">
            ${queries.map(item => `
              <div class="query-item" onclick="refineWithQuery('${item.query}')">
                <span class="query-icon">${item.icon}</span>
                <span class="query-text">${item.text}</span>
                <span class="query-arrow">â†’</span>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }

    // æ¸²æŸ“æ”»ç•¥å¡ç‰‡
    function renderGuideCard(guide) {
      return `
        <div class="guide-card">
          <h3>ğŸ“– ${guide.title}</h3>
          <div class="desc">${guide.content}</div>
          ${guide.tips ? `
            <div style="margin-top:16px">
              <div style="font-weight:700;margin-bottom:8px;color:var(--brand3)">ğŸ’¡ å®ç”¨å°è´´å£«ï¼š</div>
              ${guide.tips.map(tip => `<div style="color:var(--muted);font-size:13px;margin-bottom:4px">â€¢ ${tip}</div>`).join('')}
            </div>
          ` : ''}
          <div class="game-actions" style="margin-top:16px">
            <button class="btn-primary" onclick="getMoreGuides('${guide.title}')">æŸ¥çœ‹æ›´å¤šæ”»ç•¥</button>
            <button class="btn-ghost" onclick="saveGuide('${guide.title}')">æ”¶è—æ”»ç•¥</button>
          </div>
        </div>
      `;
    }

    // æ¸²æŸ“ä»˜è´¹å»ºè®®å¡ç‰‡
    function renderPaymentCard(advice) {
      return `
        <div class="taste-card" style="border-top: 2px solid var(--gold)">
          <h3>ğŸ’ ${advice.title}</h3>
          <div class="desc">${advice.content}</div>
          ${advice.recommendations ? `
            <div style="margin-top:16px">
              <div style="font-weight:700;margin-bottom:8px;color:var(--gold)">ğŸ’° ä¸“ä¸šå»ºè®®ï¼š</div>
              ${advice.recommendations.map(rec => `<div style="color:var(--muted);font-size:13px;margin-bottom:4px">â€¢ ${rec}</div>`).join('')}
            </div>
          ` : ''}
        </div>
      `;
    }

    // ä¸»è¦åŠŸèƒ½å‡½æ•°
    function analyzeGame() {
      const gameName = gameInput.value.trim();
      if (!gameName) {
        smartSuggestions.classList.add('show');
        showToast('é€‰æ‹©ä¸Šæ–¹å»ºè®®æˆ–å‘Šè¯‰æˆ‘ä½ åœ¨ç©çš„æ¸¸æˆ ğŸ˜Š');
        return;
      }

      addMessage(`æˆ‘æœ€è¿‘åœ¨ç©ï¼š<strong>${gameName}</strong>`, 'user');
      smartSuggestions.classList.remove('show');

      const thinkingMsg = addMessage(`
        <div class="thinking">
          <span>æ­£åœ¨åˆ†æä½ çš„æ¸¸æˆå“å‘³</span>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
        </div>
      `);

      setTimeout(() => {
        thinkingMsg.remove();
        
        const profile = gameProfiles[gameName] || gameProfiles['ç¬¬äº”äººæ ¼'];
        const profileMsg = addMessage(renderTasteProfile(gameName, profile));
        
        setTimeout(() => {
          const chartId = profileMsg.querySelector('svg').id;
          drawRadarChart(chartId, profile.dna);
        }, 100);

        setTimeout(() => {
          const recommendation = generateRecommendation(profile.dna);
          addMessage(renderRecommendation(recommendation));
          
          setTimeout(() => {
            addMessage(renderQuickFeedback());
          }, 800);
        }, 1200);
        
      }, 2000);

      gameInput.value = '';
    }

    function getGameGuide() {
      const query = guideInput.value.trim();
      if (!query) {
        smartSuggestions.classList.add('show');
        showToast('å‘Šè¯‰æˆ‘ä½ éœ€è¦ä»€ä¹ˆæ¸¸æˆçš„æ”»ç•¥ ğŸ“–');
        return;
      }

      addMessage(`æˆ‘æƒ³äº†è§£ï¼š<strong>${query}</strong>`, 'user');
      smartSuggestions.classList.remove('show');

      const thinkingMsg = addMessage(`
        <div class="thinking">
          <span>æ­£åœ¨ä¸ºä½ æ•´ç†æ”»ç•¥</span>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
        </div>
      `);

      setTimeout(() => {
        thinkingMsg.remove();
        
        // æŸ¥æ‰¾åŒ¹é…çš„æ”»ç•¥
        const matchedGuide = Object.entries(gameGuides).find(([key]) => 
          query.includes(key) || key.includes(query)
        );
        
        const guide = matchedGuide ? matchedGuide[1] : {
          title: 'ä¸ºä½ å®šåˆ¶çš„æ”»ç•¥å»ºè®®',
          content: `åŸºäºä½ çš„é—®é¢˜"${query}"ï¼Œæˆ‘å»ºè®®ï¼š<br>â€¢ å…ˆäº†è§£æ¸¸æˆåŸºç¡€æœºåˆ¶å’Œæ“ä½œ<br>â€¢ è§‚çœ‹ç›¸å…³æ¸¸æˆè§†é¢‘æ•™ç¨‹<br>â€¢ åŠ å…¥æ¸¸æˆå®˜æ–¹ç¾¤æˆ–è®ºå›äº¤æµ<br>â€¢ ä»ç®€å•æ¨¡å¼å¼€å§‹ç»ƒä¹ <br>â€¢ å¤šå®æˆ˜æ€»ç»“ç»éªŒ`,
          tips: ['è€å¿ƒç»ƒä¹ æ˜¯æå‡çš„å…³é”®', 'å‘é«˜æ‰‹å­¦ä¹ ä½†ä¸ç›²ç›®æ¨¡ä»¿', 'ä¿æŒè‰¯å¥½çš„æ¸¸æˆå¿ƒæ€']
        };
        
        addMessage(renderGuideCard(guide));
      }, 1500);

      guideInput.value = '';
    }

    function getPaymentAdvice() {
      const query = paymentInput.value.trim();
      if (!query) {
        smartSuggestions.classList.add('show');
        showToast('å‘Šè¯‰æˆ‘ä½ æƒ³å’¨è¯¢çš„ä»˜è´¹é—®é¢˜ ğŸ’');
        return;
      }

      addMessage(`æˆ‘æƒ³å’¨è¯¢ï¼š<strong>${query}</strong>`, 'user');
      smartSuggestions.classList.remove('show');

      const thinkingMsg = addMessage(`
        <div class="thinking">
          <span>æ­£åœ¨åˆ†æä»˜è´¹æ€§ä»·æ¯”</span>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
        </div>
      `);

      setTimeout(() => {
        thinkingMsg.remove();
        
        const matchedAdvice = Object.entries(paymentAdvices).find(([key]) => 
          query.includes(key) || key.includes(query)
        );
        
        const advice = matchedAdvice ? matchedAdvice[1] : {
          title: 'ä¸ªæ€§åŒ–ä»˜è´¹å»ºè®®',
          content: `å…³äº"${query}"çš„ä»˜è´¹å»ºè®®ï¼š<br>â€¢ é¦–å…ˆè¯„ä¼°è¿™ä¸ªæ¶ˆè´¹æ˜¯å¦å¿…è¦<br>â€¢ å¯¹æ¯”ä¸åŒæ¸ é“çš„ä»·æ ¼å’Œä¼˜æƒ <br>â€¢ è€ƒè™‘é•¿æœŸä»·å€¼è€ŒéçŸ­æœŸå¿«æ„Ÿ<br>â€¢ è®¾å®šåˆç†çš„æœˆåº¦æ¸¸æˆé¢„ç®—<br>â€¢ ä¼˜å…ˆè´­ä¹°èƒ½é•¿æœŸå—ç›Šçš„å†…å®¹`,
          recommendations: ['ç†æ€§æ¶ˆè´¹ï¼Œé¿å…å†²åŠ¨è´­ä¹°', 'å…³æ³¨å®˜æ–¹æ´»åŠ¨å’ŒæŠ˜æ‰£', 'å¯ä»¥ç­‰å¾…æ›´å¥½çš„æ—¶æœº']
        };
        
        addMessage(renderPaymentCard(advice));
      }, 1500);

      paymentInput.value = '';
    }

    function sendChatMessage() {
      const message = chatInput.value.trim();
      if (!message) {
        smartSuggestions.classList.add('show');
        showToast('éšä¾¿èŠèŠæ¸¸æˆç›¸å…³çš„è¯é¢˜å§ ğŸ’¬');
        return;
      }

      addMessage(`${message}`, 'user');
      smartSuggestions.classList.remove('show');

      const thinkingMsg = addMessage(`
        <div class="thinking">
          <span>æ­£åœ¨æ€è€ƒå›å¤</span>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
        </div>
      `);

      setTimeout(() => {
        thinkingMsg.remove();
        
        // ç®€å•çš„èŠå¤©å›å¤é€»è¾‘
        let response = '';
        if (message.includes('æ¨è') || message.includes('å¥½ç©')) {
          response = 'ğŸ® å…³äºæ¸¸æˆæ¨èï¼Œæˆ‘è§‰å¾—æœ€é‡è¦çš„æ˜¯æ‰¾åˆ°é€‚åˆä½ çš„ç±»å‹ï¼ä½ æ¯”è¾ƒå–œæ¬¢ä»€ä¹ˆé£æ ¼çš„æ¸¸æˆå‘¢ï¼Ÿæ¯”å¦‚ç«æŠ€ã€ä¼‘é—²ã€ç­–ç•¥è¿˜æ˜¯è§’è‰²æ‰®æ¼”ï¼Ÿ';
        } else if (message.includes('å……å€¼') || message.includes('æ°ªé‡‘')) {
          response = 'ğŸ’° å…³äºæ¸¸æˆæ¶ˆè´¹ï¼Œæˆ‘çš„å»ºè®®æ˜¯ç†æ€§ä¸ºä¸»ã€‚å¯ä»¥å…ˆä½“éªŒå…è´¹å†…å®¹ï¼Œç¡®å®å–œæ¬¢å†è€ƒè™‘é€‚åº¦æ”¯æŒã€‚è®°ä½æ¸¸æˆæ˜¯ä¸ºäº†å¿«ä¹ï¼Œä¸è¦è®©ä»˜è´¹æˆä¸ºè´Ÿæ‹…å“¦ï¼';
        } else if (message.includes('æ‰‹æ¸¸') || message.includes('ç«¯æ¸¸')) {
          response = 'ğŸ“± æ‰‹æ¸¸å’Œç«¯æ¸¸å„æœ‰ä¼˜åŠ¿å‘¢ï¼æ‰‹æ¸¸æ–¹ä¾¿éšæ—¶éšåœ°ç©ï¼Œç«¯æ¸¸ä½“éªŒæ›´ä¸°å¯Œæ·±åº¦æ›´é«˜ã€‚ä½ å¹³æ—¶æ›´å–œæ¬¢å“ªç§æ¸¸æˆå¹³å°ï¼Ÿ';
        } else {
          response = `ğŸ˜Š å“ˆå“ˆï¼Œå…³äº"${message}"è¿™ä¸ªè¯é¢˜å¾ˆæœ‰è¶£ï¼ä½œä¸ºæ¸¸æˆåŠ©æ‰‹ï¼Œæˆ‘å¾ˆä¹æ„å’Œä½ èŠæ¸¸æˆã€‚ä½ è¿˜æƒ³äº†è§£ä»€ä¹ˆæ¸¸æˆç›¸å…³çš„å†…å®¹å—ï¼Ÿæˆ‘å¯ä»¥å¸®ä½ æ¨èã€æä¾›æ”»ç•¥æˆ–è€…ä»˜è´¹å»ºè®®å“¦ï¼`;
        }
        
        addMessage(response);
      }, 1000);

      chatInput.value = '';
    }

    // åé¦ˆå¤„ç†å‡½æ•°
    function handlePositiveFeedback() {
      addMessage(`
        <div class="taste-card" style="border-top: 2px solid var(--brand3)">
          <h3>ğŸ‰ å¤ªæ£’äº†ï¼</h3>
          <div class="desc" style="color: var(--brand3);">
            æˆ‘å·²ç»è®°ä½äº†ä½ çš„å–œå¥½ï¼Œä¸‹æ¬¡æ¨èä¼šæ›´ç²¾å‡†ã€‚<br>
            <strong>ç»§ç»­å‘Šè¯‰æˆ‘å…¶ä»–æ¸¸æˆï¼Œè®©æˆ‘æ›´æ‡‚ä½ çš„å“å‘³å§ï¼</strong>
          </div>
        </div>
      `);
      showToast('å·²è®°å½•ä½ çš„å–œå¥½åå‘ âœ¨', 'success');
    }

    function showSmartQueries() {
      addMessage(renderSmartQueries());
    }

    function refineWithQuery(query) {
      addMessage(`æˆ‘çš„å…·ä½“éœ€æ±‚ï¼š<strong>${query}</strong>`, 'user');
      
      const thinkingMsg = addMessage(`
        <div class="thinking">
          <span>åŸºäºä½ çš„éœ€æ±‚é‡æ–°åˆ†æ</span>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
          <div class="thinking-dot"></div>
        </div>
      `);

      setTimeout(() => {
        thinkingMsg.remove();
        
        // æ ¹æ®å…·ä½“éœ€æ±‚ç”Ÿæˆå®šåˆ¶æ¨è
        let customGame = {
          name: 'é‡èº«å®šåˆ¶æ¨è',
          reason: 'åŸºäºä½ çš„å…·ä½“éœ€æ±‚ç²¾å¿ƒæŒ‘é€‰',
          icon: 'âœ¨'
        };

        if (query.includes('ä¼‘é—²è½»æ¾')) {
          customGame = {
            name: 'å¼€å¿ƒæ¶ˆæ¶ˆä¹',
            reason: 'ç»å…¸ä¸‰æ¶ˆæ¸¸æˆï¼Œæ“ä½œç®€å•ï¼Œéšæ—¶å¯ç©å¯åœï¼Œå®Œç¾çš„ä¼‘é—²ä¹‹é€‰',
            icon: 'ğŸ­'
          };
        } else if (query.includes('å¿«æ›´åˆºæ¿€')) {
          customGame = {
            name: 'å’Œå¹³ç²¾è‹±',
            reason: 'å¿«èŠ‚å¥æˆ˜æœ¯ç«æŠ€ï¼Œè‚¾ä¸Šè…ºç´ é£™å‡çš„åˆºæ¿€ä½“éªŒï¼Œæ¯å±€éƒ½æ˜¯æ–°æŒ‘æˆ˜',
            icon: 'ğŸ¯'
          };
        } else if (query.includes('ç¤¾äº¤æ¸¸æˆ')) {
          customGame = {
            name: 'è›‹ä»”æ´¾å¯¹',
            reason: 'è¶…èŒå¤šäººé—¯å…³ï¼Œå’Œæœ‹å‹ä¸€èµ·ææ€ªäº’å‘ï¼Œç¤¾äº¤å¨±ä¹ä¸¤ä¸è¯¯',
            icon: 'ğŸ¥š'
          };
        } else if (query.includes('ç­–ç•¥è§£è°œ')) {
          customGame = {
            name: 'çºªå¿µç¢‘è°·',
            reason: 'è§†é”™è§‰è§£è°œç¥ä½œï¼Œç²¾ç¾è‰ºæœ¯é£æ ¼é…åˆçƒ§è„‘è°œé¢˜ï¼Œç­–ç•¥æ€§åè¶³',
            icon: 'ğŸ›ï¸'
          };
        } else if (query.includes('å…è´¹') || query.includes('ä½ä»˜è´¹')) {
          customGame = {
            name: 'ç‹è€…è£è€€',
            reason: 'å®Œå…¨å…è´¹çš„MOBAæ¸¸æˆï¼Œè‹±é›„è½®æ¢å…è´¹ä½¿ç”¨ï¼ŒæŠ€æœ¯èƒœè¿‡æ°ªé‡‘',
            icon: 'ğŸ‘‘'
          };
        } else if (query.includes('ç”»é¢') || query.includes('éŸ³ä¹')) {
          customGame = {
            name: 'åŸç¥',
            reason: 'ä¸»æœºçº§ç”»é¢å“è´¨ï¼Œç®¡å¼¦ä¹å›¢é…ä¹ï¼Œè§†å¬ç››å®´çº§çš„æ¸¸æˆä½“éªŒ',
            icon: 'ğŸŒŸ'
          };
        }

        addMessage(renderRecommendation(customGame));
        
        setTimeout(() => {
          addMessage(`
            <div class="taste-card">
              <h3>ğŸ¯ è¿™æ¬¡çš„æ¨èå¦‚ä½•ï¼Ÿ</h3>
              <div class="desc">
                æˆ‘æ ¹æ®ä½ çš„åé¦ˆè¿›è¡Œäº†è°ƒæ•´ï¼Œå¸Œæœ›è¿™æ¬¡æ›´ç¬¦åˆä½ çš„æœŸå¾…ï¼<br>
                <span style="color:var(--muted);font-size:13px">å¦‚æœè¿˜ä¸æ»¡æ„ï¼Œå¯ä»¥ç»§ç»­å‘Šè¯‰æˆ‘å…·ä½“æƒ³æ³•</span>
              </div>
              <div class="game-actions" style="margin-top:12px">
                <button class="btn-primary" onclick="handlePositiveFeedback()">è¿™æ¬¡å¾ˆæ£’ï¼</button>
                <button class="btn-ghost" onclick="showSmartQueries()">è¿˜æƒ³è°ƒæ•´</button>
              </div>
            </div>
          `);
        }, 800);
        
      }, 1500);
    }

    // å·¥å…·å‡½æ•°
    function openGame(gameName) {
      showToast(`æ­£åœ¨ä¸ºä½ è·³è½¬åˆ° ${gameName} ğŸš€`);
    }

    function saveGame(gameName) {
      showToast(`${gameName} å·²åŠ å…¥ä½ çš„å¿ƒæ„¿å• ğŸ’–`, 'success');
    }

    function getMoreGuides(title) {
      showToast(`æ­£åœ¨æœç´¢æ›´å¤šå…³äº ${title} çš„æ”»ç•¥ ğŸ“š`);
    }

    function saveGuide(title) {
      showToast(`${title} å·²æ”¶è—åˆ°ä½ çš„æ”»ç•¥æœ¬ ğŸ“–`, 'success');
    }

    function getGuide(guideName) {
      guideInput.value = guideName;
      getGameGuide();
    }

    function getPaymentAdvice(adviceName) {
      paymentInput.value = adviceName;
      getPaymentAdvice();
    }

    // äº‹ä»¶ç›‘å¬å™¨è®¾ç½®
    function setupEventListeners() {
      // Tabåˆ‡æ¢
      document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
          const tabName = tab.dataset.tab;
          switchTab(tabName);
        });
      });

      // è¾“å…¥æ¡†å›è½¦äº‹ä»¶
      gameInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') analyzeGame();
      });
      
      guideInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') getGameGuide();
      });
      
      paymentInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') getPaymentAdvice();
      });
      
      chatInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendChatMessage();
      });

      // æŒ‰é’®äº‹ä»¶
      analyzeBtn.addEventListener('click', analyzeGame);
      guideBtn.addEventListener('click', getGameGuide);
      paymentBtn.addEventListener('click', getPaymentAdvice);
      chatBtn.addEventListener('click', sendChatMessage);

      // å¿«æ·æ ‡ç­¾äº‹ä»¶
      document.querySelectorAll('.tag').forEach(tag => {
        tag.addEventListener('click', () => {
          const gameName = tag.dataset.game;
          if (gameName) {
            gameInput.value = gameName;
            analyzeGame();
          } else {
            // å¤„ç†å…¶ä»–ç±»å‹çš„æ ‡ç­¾ç‚¹å‡»
            const clickHandler = tag.getAttribute('onclick');
            if (clickHandler) {
              eval(clickHandler);
            }
          }
        });
      });

      // è¾“å…¥æ¡†ç„¦ç‚¹äº‹ä»¶ - æ˜¾ç¤ºæ™ºèƒ½å»ºè®®
      const inputs = [gameInput, guideInput, paymentInput, chatInput];
      inputs.forEach(input => {
        input.addEventListener('focus', () => {
          if (!input.value.trim()) {
            smartSuggestions.classList.add('show');
          }
        });
        
        input.addEventListener('input', () => {
          if (input.value.trim()) {
            smartSuggestions.classList.remove('show');
          }
        });
      });

      // ç‚¹å‡»å…¶ä»–åŒºåŸŸéšè—å»ºè®®
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.smart-suggestions') && !e.target.closest('.input-bar')) {
          smartSuggestions.classList.remove('show');
        }
      });
    }

    // æš´éœ²å…¨å±€å‡½æ•°
    window.handlePositiveFeedback = handlePositiveFeedback;
    window.showSmartQueries = showSmartQueries;
    window.refineWithQuery = refineWithQuery;
    window.useSmartSuggestion = useSmartSuggestion;
    window.openGame = openGame;
    window.saveGame = saveGame;
    window.getMoreGuides = getMoreGuides;
    window.saveGuide = saveGuide;
    window.getGuide = getGuide;
    window.getPaymentAdvice = getPaymentAdvice;

    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
      setupEventListeners();
      updateSmartSuggestions('recommend');
      
      // ç³»ç»Ÿè‡ªæ£€
      setTimeout(() => {
        const tests = [
          { name: 'æ¸¸æˆæ¡£æ¡ˆæ•°æ®åŠ è½½', pass: Object.keys(gameProfiles).length > 0 },
          { name: 'æ¨èç³»ç»Ÿåˆå§‹åŒ–', pass: Object.keys(gameRecommendations).length > 0 },
          { name: 'æ”»ç•¥ç³»ç»ŸåŠ è½½', pass: Object.keys(gameGuides).length > 0 },
          { name: 'ä»˜è´¹å»ºè®®ç³»ç»Ÿ', pass: Object.keys(paymentAdvices).length > 0 },
          { name: 'DOMå…ƒç´ æŒ‚è½½', pass: !!document.getElementById('conversation') },
          { name: 'Tabåˆ‡æ¢åŠŸèƒ½', pass: typeof switchTab === 'function' },
          { name: 'å…¨å±€å‡½æ•°æš´éœ²', pass: typeof window.handlePositiveFeedback === 'function' }
        ];
        
        const allPassed = tests.every(t => t.pass);
        const toast = document.createElement('div');
        toast.className = 'toast';
        toast.style.background = allPassed ? 'rgba(16,185,129,0.2)' : 'rgba(239,68,68,0.2)';
        toast.style.borderColor = allPassed ? 'rgba(16,185,129,0.4)' : 'rgba(239,68,68,0.4)';
        toast.innerHTML = `${allPassed ? 'âœ…' : 'âŒ'} æ¸¸æˆAIåŠ©æ‰‹å·²å°±ç»ª Â· ${allPassed ? 'æ‰€æœ‰åŠŸèƒ½æ­£å¸¸' : 'éƒ¨åˆ†åŠŸèƒ½å¼‚å¸¸'}`;
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
      }, 500);
    });
  </script>
</body>
</html>